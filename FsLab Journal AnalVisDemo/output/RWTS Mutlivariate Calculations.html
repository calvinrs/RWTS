<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <!--
      The RWTS - Multivariate Statistics parameters will be replaced with the
      document title extracted from the <h1> element or
      file name, if there is no <h1> heading
    -->
    <title>RWTS - Multivariate Statistics</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://code.jquery.com/jquery-2.2.4.min.js"></script>
    <script src="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/js/bootstrap.min.js"></script>
    <link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap-combined.min.css" rel="stylesheet">
    <link type="text/css" rel="stylesheet" href="styles/style.css" />
    <script src="styles/tips.js" type="text/javascript"></script>
    
    <script language="javascript" type="text/javascript">
      function init()
      {
        try {
          websocket = new WebSocket("ws://" + window.location.hostname + ":" + window.location.port + "/websocket");
          websocket.onmessage = function(evt) { location.reload(); };
        } catch (e) { /* silently ignore lack of websockets */ }
      }
      window.addEventListener("load", init, false);
    </script>
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="container">
      <div class="masthead">
        <ul class="nav nav-pills pull-right">
          <li><a href="http://fslab.org">fslab.org</a></li>
          <li><a href="http://fsharp.github.io/FSharp.Data/">F# Data</a></li>
          <li><a href="http://bluemountaincapital.github.io/Deedle">Deedle</a></li>
          <li><a href="http://bluemountaincapital.github.io/FSharpRProvider">R Provider</a></li>
          <li><a href="http://tahahachana.github.io/XPlot/">XPlot</a></li>
          <li><a href="http://www.mathdotnet.com/">Math.Net</a></li>
        </ul>
        <h3 class="muted">Journal</h3>
      </div>
      <hr />
      <div class="row" style="margin-top:30px">
        <div class="span1"></div>
        <div class="span10" id="main">
          <h1>RWTS - Multivariate Statistics</h1>
<p>Multivariate - using more than one variable.</p>
<p>For RWTS, that is to say focusing on multiple Asset at a time, focusing on the relationship between assets - i.e. correlation-style calculations.</p>
<h1>Required Packages</h1>
<p>We will require references to:</p>
<p>System - for DateTime</p>
<p>Deedle - to arrange time series data into Key -&gt; Value "Frames"</p>
<p>Mathnet.Numerics - for off the shelf statistical functions</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">open</span> <span onmouseout="hideTip(event, 'fs1', 1)" onmouseover="showTip(event, 'fs1', 1)" class="i">System</span>
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs2', 2)" onmouseover="showTip(event, 'fs2', 2)" class="i">Deedle</span>

<span class="k">open</span> <span onmouseout="hideTip(event, 'fs3', 3)" onmouseover="showTip(event, 'fs3', 3)" class="i">MathNet</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs4', 4)" onmouseover="showTip(event, 'fs4', 4)" class="i">Numerics</span>
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs3', 5)" onmouseover="showTip(event, 'fs3', 5)" class="i">MathNet</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs4', 6)" onmouseover="showTip(event, 'fs4', 6)" class="i">Numerics</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs5', 7)" onmouseover="showTip(event, 'fs5', 7)" class="i">Statistics</span>;
</code></pre></td>
</tr>
</table>
<h1>Data Import</h1>
<p>Like in the multivariate case , we can mock up a "database" of time series data by pulling in a full set of data, up to EndDec2016.
Here, we will jump ahead to the "Annualised quarterly returns" series - this will mimic the process when we have a tool or service that will provide returns as a time series.<br />
The data here is the original RWTS total return results from the database.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="c">// I can create a function to return all &lt;float&gt; values for each Asset</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs7', 9)" onmouseover="showTip(event, 'fs7', 9)" class="f">ReturnSeries</span> (<span onmouseout="hideTip(event, 'fs8', 10)" onmouseover="showTip(event, 'fs8', 10)" class="i">allSeries</span><span class="o">:</span> <span onmouseout="hideTip(event, 'fs9', 11)" onmouseover="showTip(event, 'fs9', 11)" class="t">Frame</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs10', 12)" onmouseover="showTip(event, 'fs10', 12)" class="t">DateTime</span>,<span onmouseout="hideTip(event, 'fs11', 13)" onmouseover="showTip(event, 'fs11', 13)" class="t">string</span><span class="o">&gt;</span>) <span onmouseout="hideTip(event, 'fs12', 14)" onmouseover="showTip(event, 'fs12', 14)" class="i">asset</span> <span class="o">=</span> 
    <span onmouseout="hideTip(event, 'fs8', 15)" onmouseover="showTip(event, 'fs8', 15)" class="i">allSeries</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs13', 16)" onmouseover="showTip(event, 'fs13', 16)" class="f">GetColumn</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs11', 17)" onmouseover="showTip(event, 'fs11', 17)" class="t">string</span><span class="o">&gt;</span>(<span onmouseout="hideTip(event, 'fs12', 18)" onmouseover="showTip(event, 'fs12', 18)" class="i">asset</span>) <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs14', 19)" onmouseover="showTip(event, 'fs14', 19)" class="t">Series</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs15', 20)" onmouseover="showTip(event, 'fs15', 20)" class="f">filter</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs16', 21)" onmouseover="showTip(event, 'fs16', 21)" class="i">k</span> <span onmouseout="hideTip(event, 'fs17', 22)" onmouseover="showTip(event, 'fs17', 22)" class="i">v</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs17', 23)" onmouseover="showTip(event, 'fs17', 23)" class="i">v</span> <span class="o">&lt;&gt;</span> <span class="s">&quot;null&quot;</span>) <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs14', 24)" onmouseover="showTip(event, 'fs14', 24)" class="t">Series</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs18', 25)" onmouseover="showTip(event, 'fs18', 25)" class="f">map</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs16', 26)" onmouseover="showTip(event, 'fs16', 26)" class="i">k</span> <span onmouseout="hideTip(event, 'fs17', 27)" onmouseover="showTip(event, 'fs17', 27)" class="i">v</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs19', 28)" onmouseover="showTip(event, 'fs19', 28)" class="f">float</span> <span onmouseout="hideTip(event, 'fs17', 29)" onmouseover="showTip(event, 'fs17', 29)" class="i">v</span>)

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs20', 30)" onmouseover="showTip(event, 'fs20', 30)" class="i">XSReturnsfromCSV</span> <span class="o">=</span> 
    <span onmouseout="hideTip(event, 'fs9', 31)" onmouseover="showTip(event, 'fs9', 31)" class="t">Frame</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs21', 32)" onmouseover="showTip(event, 'fs21', 32)" class="f">ReadCsv</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs10', 33)" onmouseover="showTip(event, 'fs10', 33)" class="t">DateTime</span><span class="o">&gt;</span>(<span onmouseout="hideTip(event, 'fs6', 34)" onmouseover="showTip(event, 'fs6', 34)" class="i">root</span> <span class="o">+</span> <span class="s">&quot;HistoricReturnsQuarterly_EndDec2016_InColumns.csv&quot;</span>, <span class="i">indexCol</span><span class="o">=</span><span class="s">&quot;Index&quot;</span>, <span class="i">missingValues</span><span class="o">=</span>[|<span class="s">&quot;null&quot;</span>|])
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs9', 35)" onmouseover="showTip(event, 'fs9', 35)" class="t">Frame</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs22', 36)" onmouseover="showTip(event, 'fs22', 36)" class="f">sortRowsByKey</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs23', 37)" onmouseover="showTip(event, 'fs23', 37)" class="f">returnXSReturnSeries</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs7', 38)" onmouseover="showTip(event, 'fs7', 38)" class="f">ReturnSeries</span> <span onmouseout="hideTip(event, 'fs20', 39)" onmouseover="showTip(event, 'fs20', 39)" class="i">XSReturnsfromCSV</span>

<span class="c">// We can now call this function to &quot;import&quot; our time series of data</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs24', 40)" onmouseover="showTip(event, 'fs24', 40)" class="i">testXSRetSeries</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs23', 41)" onmouseover="showTip(event, 'fs23', 41)" class="f">returnXSReturnSeries</span> <span class="s">&quot;E_CNY&quot;</span>
</code></pre></td>
</tr>
</table>
<h1>Historic 10Y Correlations</h1>
<p>We can introduce how we will approach multivariate statistics by taking the simplest example.<br />
We wish to calculate "Historic 10Y Correlations", which are simply the correlation between asset returns over the last 10 years.</p>
<p>So to calculate correlation between a number of assets, we will need to pull in all avaliable returns for our assets.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs25', 42)" onmouseover="showTip(event, 'fs25', 42)" class="i">exampleReturnDataFrame</span> <span class="o">=</span> [ 
      <span class="s">&quot;ASX_200_A_REIT&quot;</span> <span class="o">=&gt;</span> <span onmouseout="hideTip(event, 'fs23', 43)" onmouseover="showTip(event, 'fs23', 43)" class="f">returnXSReturnSeries</span> <span class="s">&quot;ASX_200_A_REIT&quot;</span>;  
      <span class="s">&quot;ASX_200_BANKS&quot;</span> <span class="o">=&gt;</span> <span onmouseout="hideTip(event, 'fs23', 44)" onmouseover="showTip(event, 'fs23', 44)" class="f">returnXSReturnSeries</span> <span class="s">&quot;ASX_200_BANKS&quot;</span> ;
      <span class="s">&quot;China_25&quot;</span> <span class="o">=&gt;</span> <span onmouseout="hideTip(event, 'fs23', 45)" onmouseover="showTip(event, 'fs23', 45)" class="f">returnXSReturnSeries</span> <span class="s">&quot;China_25&quot;</span>] <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs9', 46)" onmouseover="showTip(event, 'fs9', 46)" class="t">Frame</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs26', 47)" onmouseover="showTip(event, 'fs26', 47)" class="f">ofColumns</span>
</code></pre></td>
</tr>
</table>
<p>To define the 10Y period, we will need to define our calibraiton date.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs27', 48)" onmouseover="showTip(event, 'fs27', 48)" class="i">calibrationDate</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs10', 49)" onmouseover="showTip(event, 'fs10', 49)" class="t">DateTime</span>(<span class="n">2016</span>, <span class="n">12</span>, <span class="n">31</span>)
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs28', 50)" onmouseover="showTip(event, 'fs28', 50)" class="i">tenYearsAgo</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs27', 51)" onmouseover="showTip(event, 'fs27', 51)" class="i">calibrationDate</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs29', 52)" onmouseover="showTip(event, 'fs29', 52)" class="f">AddYears</span>(<span class="o">-</span><span class="n">10</span>)

<span class="c">// slice on a series</span>
<span onmouseout="hideTip(event, 'fs24', 53)" onmouseover="showTip(event, 'fs24', 53)" class="i">testXSRetSeries</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs30', 54)" onmouseover="showTip(event, 'fs30', 54)" class="f">Between</span>(<span onmouseout="hideTip(event, 'fs28', 55)" onmouseover="showTip(event, 'fs28', 55)" class="i">tenYearsAgo</span>, <span onmouseout="hideTip(event, 'fs27', 56)" onmouseover="showTip(event, 'fs27', 56)" class="i">calibrationDate</span>)
<span class="c">// or on the combined frame</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs31', 57)" onmouseover="showTip(event, 'fs31', 57)" class="i">exampleHist10YReturns</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs25', 58)" onmouseover="showTip(event, 'fs25', 58)" class="i">exampleReturnDataFrame</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs9', 59)" onmouseover="showTip(event, 'fs9', 59)" class="t">Frame</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs32', 60)" onmouseover="showTip(event, 'fs32', 60)" class="f">filterRows</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs16', 61)" onmouseover="showTip(event, 'fs16', 61)" class="i">k</span> <span onmouseout="hideTip(event, 'fs33', 62)" onmouseover="showTip(event, 'fs33', 62)" class="i">v</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs16', 63)" onmouseover="showTip(event, 'fs16', 63)" class="i">k</span> <span class="o">&gt;</span> <span onmouseout="hideTip(event, 'fs28', 64)" onmouseover="showTip(event, 'fs28', 64)" class="i">tenYearsAgo</span> <span class="o">&amp;&amp;</span> <span onmouseout="hideTip(event, 'fs16', 65)" onmouseover="showTip(event, 'fs16', 65)" class="i">k</span> <span class="o">&lt;=</span> <span onmouseout="hideTip(event, 'fs27', 66)" onmouseover="showTip(event, 'fs27', 66)" class="i">calibrationDate</span>)
</code></pre></td>
</tr>
</table>
<p>Now that we have identically alligned time series, and assuming no missing values, we can take these series and calculate the correlation between them.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs34', 67)" onmouseover="showTip(event, 'fs34', 67)" class="i">myX</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs31', 68)" onmouseover="showTip(event, 'fs31', 68)" class="i">exampleHist10YReturns</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs13', 69)" onmouseover="showTip(event, 'fs13', 69)" class="f">GetColumn</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs19', 70)" onmouseover="showTip(event, 'fs19', 70)" class="t">float</span><span class="o">&gt;</span>(<span class="s">&quot;ASX_200_A_REIT&quot;</span>)<span class="o">.</span><span class="i">ValuesAll</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs35', 71)" onmouseover="showTip(event, 'fs35', 71)" class="i">myY</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs31', 72)" onmouseover="showTip(event, 'fs31', 72)" class="i">exampleHist10YReturns</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs13', 73)" onmouseover="showTip(event, 'fs13', 73)" class="f">GetColumn</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs19', 74)" onmouseover="showTip(event, 'fs19', 74)" class="t">float</span><span class="o">&gt;</span>(<span class="s">&quot;ASX_200_BANKS&quot;</span>)<span class="o">.</span><span class="i">ValuesAll</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs36', 75)" onmouseover="showTip(event, 'fs36', 75)" class="i">myZ</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs31', 76)" onmouseover="showTip(event, 'fs31', 76)" class="i">exampleHist10YReturns</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs13', 77)" onmouseover="showTip(event, 'fs13', 77)" class="f">GetColumn</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs19', 78)" onmouseover="showTip(event, 'fs19', 78)" class="t">float</span><span class="o">&gt;</span>(<span class="s">&quot;China_25&quot;</span>)<span class="o">.</span><span class="i">ValuesAll</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs37', 79)" onmouseover="showTip(event, 'fs37', 79)" class="i">myCorrelXY</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs38', 80)" onmouseover="showTip(event, 'fs38', 80)" class="i">Statistics</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs39', 81)" onmouseover="showTip(event, 'fs39', 81)" class="t">Correlation</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs40', 82)" onmouseover="showTip(event, 'fs40', 82)" class="f">Pearson</span>(<span onmouseout="hideTip(event, 'fs34', 83)" onmouseover="showTip(event, 'fs34', 83)" class="i">myX</span>, <span onmouseout="hideTip(event, 'fs35', 84)" onmouseover="showTip(event, 'fs35', 84)" class="i">myY</span>)
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs41', 85)" onmouseover="showTip(event, 'fs41', 85)" class="i">myCorrelXZ</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs38', 86)" onmouseover="showTip(event, 'fs38', 86)" class="i">Statistics</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs39', 87)" onmouseover="showTip(event, 'fs39', 87)" class="t">Correlation</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs40', 88)" onmouseover="showTip(event, 'fs40', 88)" class="f">Pearson</span>(<span onmouseout="hideTip(event, 'fs34', 89)" onmouseover="showTip(event, 'fs34', 89)" class="i">myX</span>, <span onmouseout="hideTip(event, 'fs36', 90)" onmouseover="showTip(event, 'fs36', 90)" class="i">myZ</span>)
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs42', 91)" onmouseover="showTip(event, 'fs42', 91)" class="i">myCorrelYZ</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs38', 92)" onmouseover="showTip(event, 'fs38', 92)" class="i">Statistics</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs39', 93)" onmouseover="showTip(event, 'fs39', 93)" class="t">Correlation</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs40', 94)" onmouseover="showTip(event, 'fs40', 94)" class="f">Pearson</span>(<span onmouseout="hideTip(event, 'fs35', 95)" onmouseover="showTip(event, 'fs35', 95)" class="i">myY</span>, <span onmouseout="hideTip(event, 'fs36', 96)" onmouseover="showTip(event, 'fs36', 96)" class="i">myZ</span>)
</code></pre></td>
</tr>
</table>
<p>We can arrange this data into a matrix if we wish, using the LinearAlgebra package's matrix type.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">open</span> <span onmouseout="hideTip(event, 'fs3', 97)" onmouseover="showTip(event, 'fs3', 97)" class="i">MathNet</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs4', 98)" onmouseover="showTip(event, 'fs4', 98)" class="i">Numerics</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs43', 99)" onmouseover="showTip(event, 'fs43', 99)" class="i">LinearAlgebra</span>;

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs44', 100)" onmouseover="showTip(event, 'fs44', 100)" class="i">correlMatrix</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs45', 101)" onmouseover="showTip(event, 'fs45', 101)" class="f">matrix</span> [ [<span class="n">1.0</span>; <span onmouseout="hideTip(event, 'fs37', 102)" onmouseover="showTip(event, 'fs37', 102)" class="i">myCorrelXY</span>; <span onmouseout="hideTip(event, 'fs41', 103)" onmouseover="showTip(event, 'fs41', 103)" class="i">myCorrelXZ</span>]
                            [<span onmouseout="hideTip(event, 'fs37', 104)" onmouseover="showTip(event, 'fs37', 104)" class="i">myCorrelXY</span>; <span class="n">1.0</span>; <span onmouseout="hideTip(event, 'fs42', 105)" onmouseover="showTip(event, 'fs42', 105)" class="i">myCorrelYZ</span>]
                            [<span onmouseout="hideTip(event, 'fs41', 106)" onmouseover="showTip(event, 'fs41', 106)" class="i">myCorrelXZ</span>; <span onmouseout="hideTip(event, 'fs42', 107)" onmouseover="showTip(event, 'fs42', 107)" class="i">myCorrelYZ</span>; <span class="n">1.0</span>] ]
</code></pre></td>
</tr>
</table>
<p>BONUS: We can test if a matrix is PSD like so:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs46', 108)" onmouseover="showTip(event, 'fs46', 108)" class="f">isPSD</span> (<span onmouseout="hideTip(event, 'fs47', 109)" onmouseover="showTip(event, 'fs47', 109)" class="i">matrix</span><span class="o">:</span> <span onmouseout="hideTip(event, 'fs48', 110)" onmouseover="showTip(event, 'fs48', 110)" class="t">Matrix</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs19', 111)" onmouseover="showTip(event, 'fs19', 111)" class="t">float</span><span class="o">&gt;</span>) <span class="o">=</span> <span onmouseout="hideTip(event, 'fs47', 112)" onmouseover="showTip(event, 'fs47', 112)" class="i">matrix</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs49', 113)" onmouseover="showTip(event, 'fs49', 113)" class="f">Evd</span>()<span class="o">.</span><span class="i">EigenValues</span><span class="o">.</span><span class="f">Real</span>() <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs50', 114)" onmouseover="showTip(event, 'fs50', 114)" class="t">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs51', 115)" onmouseover="showTip(event, 'fs51', 115)" class="f">min</span> <span class="o">&gt;</span><span class="o">=</span> <span class="n">0.000001</span>
<span onmouseout="hideTip(event, 'fs46', 116)" onmouseover="showTip(event, 'fs46', 116)" class="f">isPSD</span> <span onmouseout="hideTip(event, 'fs44', 117)" onmouseover="showTip(event, 'fs44', 117)" class="i">correlMatrix</span>
</code></pre></td>
</tr>
</table>
<p>We do not need to test this for our historic 10Y correlation matrix - its construction shoud ensure that this is true.</p>
<h1>Unconditional Correlations</h1>
<p>A slightly tricker calculation is the way in which we set our unconditional correlations.</p>
<p>Like the historic correlations, we need to work with pairs of time series.
For this calculation however, we need to be careful about the time period we are working over, conditional on the lifespan of both series in the pair.</p>
<p>For this example, we can go back in time to the pre-DB RWTS sheet, so we can compare results. The TR series are slightly different, but we should get a similar result.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
<span class="l">22: </span>
<span class="l">23: </span>
<span class="l">24: </span>
<span class="l">25: </span>
<span class="l">26: </span>
<span class="l">27: </span>
<span class="l">28: </span>
<span class="l">29: </span>
<span class="l">30: </span>
<span class="l">31: </span>
<span class="l">32: </span>
<span class="l">33: </span>
<span class="l">34: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="c">// for the EWMA part of this, we will need to determine the initialisation value and the lambda value.</span>

<span class="c">// lambda can be expressed as a value, or in terms of the Mean age of the data (25y) and the observations per year (4 for quarterly data) </span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs52', 118)" onmouseover="showTip(event, 'fs52', 118)" class="i">uncCorrelLambda</span> <span class="o">=</span> (<span class="n">1.0</span> <span class="o">-</span> (<span class="n">1.0</span><span class="o">/</span><span class="n">4.0</span>) <span class="o">/</span> <span class="n">25.0</span>) <span class="c">//0.99</span>

<span class="c">// the initialisation value is 0.005625, but will be scaled based on the asset type (equity or bond) and if the underlying economy matches for the assets</span>
<span class="c">// in our example case, we will investigate equity assets that have different underlying economies, which gives us a scaling factor of 0.5</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs53', 119)" onmouseover="showTip(event, 'fs53', 119)" class="i">uncVarInit</span> <span class="o">=</span> <span class="n">0.005625</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs54', 120)" onmouseover="showTip(event, 'fs54', 120)" class="i">uncCovarInit</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs53', 121)" onmouseover="showTip(event, 'fs53', 121)" class="i">uncVarInit</span> <span class="o">*</span> <span class="n">0.5</span>

<span class="c">// Set the calibration date</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs55', 122)" onmouseover="showTip(event, 'fs55', 122)" class="i">oldCalibrationDate</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs10', 123)" onmouseover="showTip(event, 'fs10', 123)" class="t">DateTime</span>(<span class="n">2009</span>, <span class="n">12</span>, <span class="n">31</span>)

<span class="c">// We will take a pair of TR series, and truncate these to include data up to the calibration date only</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs56', 124)" onmouseover="showTip(event, 'fs56', 124)" class="i">seriesLH</span> <span class="o">=</span>  (<span onmouseout="hideTip(event, 'fs23', 125)" onmouseover="showTip(event, 'fs23', 125)" class="f">returnXSReturnSeries</span> <span class="s">&quot;E_AUD&quot;</span>)<span class="o">.</span><span class="f">EndAt</span>(<span onmouseout="hideTip(event, 'fs55', 126)" onmouseover="showTip(event, 'fs55', 126)" class="i">oldCalibrationDate</span>)
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs57', 127)" onmouseover="showTip(event, 'fs57', 127)" class="i">seriesRH</span> <span class="o">=</span> (<span onmouseout="hideTip(event, 'fs23', 128)" onmouseover="showTip(event, 'fs23', 128)" class="f">returnXSReturnSeries</span> <span class="s">&quot;E_HKD&quot;</span>)<span class="o">.</span><span class="f">EndAt</span>(<span onmouseout="hideTip(event, 'fs55', 129)" onmouseover="showTip(event, 'fs55', 129)" class="i">oldCalibrationDate</span>)

<span class="c">// we will need to take the mean value for each series. This is over the entire lifespan of each series. </span>
<span class="c">// the Deedle Series class has its own univariate statistics, which we can use for simple stuff like mean, standard dev. etc.</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs58', 130)" onmouseover="showTip(event, 'fs58', 130)" class="i">seriesMeanLHS</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs56', 131)" onmouseover="showTip(event, 'fs56', 131)" class="i">seriesLH</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs59', 132)" onmouseover="showTip(event, 'fs59', 132)" class="f">Mean</span>()
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs60', 133)" onmouseover="showTip(event, 'fs60', 133)" class="i">seriesMeanRHS</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs57', 134)" onmouseover="showTip(event, 'fs57', 134)" class="i">seriesRH</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs59', 135)" onmouseover="showTip(event, 'fs59', 135)" class="f">Mean</span>()

<span class="c">// For the EWMA part of this calculation, we need to start at the first point in time where both series are avaliable</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs61', 136)" onmouseover="showTip(event, 'fs61', 136)" class="i">combinedStartDate</span> <span class="o">=</span> <span class="k">if</span> <span onmouseout="hideTip(event, 'fs56', 137)" onmouseover="showTip(event, 'fs56', 137)" class="i">seriesLH</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs62', 138)" onmouseover="showTip(event, 'fs62', 138)" class="f">FirstKey</span>() <span class="o">&gt;</span> <span onmouseout="hideTip(event, 'fs57', 139)" onmouseover="showTip(event, 'fs57', 139)" class="i">seriesRH</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs62', 140)" onmouseover="showTip(event, 'fs62', 140)" class="f">FirstKey</span>() <span class="k">then</span> <span onmouseout="hideTip(event, 'fs56', 141)" onmouseover="showTip(event, 'fs56', 141)" class="i">seriesLH</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs62', 142)" onmouseover="showTip(event, 'fs62', 142)" class="f">FirstKey</span>() <span class="k">else</span> <span onmouseout="hideTip(event, 'fs57', 143)" onmouseover="showTip(event, 'fs57', 143)" class="i">seriesRH</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs62', 144)" onmouseover="showTip(event, 'fs62', 144)" class="f">FirstKey</span>()

<span class="c">// we can now truncate the data series, and from now on will be working with series of equal length</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs63', 145)" onmouseover="showTip(event, 'fs63', 145)" class="i">ewmaReturnsLH</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs56', 146)" onmouseover="showTip(event, 'fs56', 146)" class="i">seriesLH</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs64', 147)" onmouseover="showTip(event, 'fs64', 147)" class="f">StartAt</span>(<span onmouseout="hideTip(event, 'fs61', 148)" onmouseover="showTip(event, 'fs61', 148)" class="i">combinedStartDate</span>)
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs65', 149)" onmouseover="showTip(event, 'fs65', 149)" class="i">ewmaReturnsRH</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs57', 150)" onmouseover="showTip(event, 'fs57', 150)" class="i">seriesRH</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs64', 151)" onmouseover="showTip(event, 'fs64', 151)" class="f">StartAt</span>(<span onmouseout="hideTip(event, 'fs61', 152)" onmouseover="showTip(event, 'fs61', 152)" class="i">combinedStartDate</span>)

<span class="c">// Use the Series mu (over all points) rather than the mean of the ewma period, to calculate the covariance</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs66', 153)" onmouseover="showTip(event, 'fs66', 153)" class="i">seriesLHMinusMu</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs63', 154)" onmouseover="showTip(event, 'fs63', 154)" class="i">ewmaReturnsLH</span> <span class="o">-</span> <span onmouseout="hideTip(event, 'fs58', 155)" onmouseover="showTip(event, 'fs58', 155)" class="i">seriesMeanLHS</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs67', 156)" onmouseover="showTip(event, 'fs67', 156)" class="i">seriesRHMinusMu</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs65', 157)" onmouseover="showTip(event, 'fs65', 157)" class="i">ewmaReturnsRH</span> <span class="o">-</span> <span onmouseout="hideTip(event, 'fs60', 158)" onmouseover="showTip(event, 'fs60', 158)" class="i">seriesMeanRHS</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs68', 159)" onmouseover="showTip(event, 'fs68', 159)" class="i">ewmaCovar</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs66', 160)" onmouseover="showTip(event, 'fs66', 160)" class="i">seriesLHMinusMu</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs67', 161)" onmouseover="showTip(event, 'fs67', 161)" class="i">seriesRHMinusMu</span>
</code></pre></td>
</tr>
</table>
<p>We can use Deedle's "Series.scanValues" to perform the EWMA weighted Covariance and series Variances.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs69', 162)" onmouseover="showTip(event, 'fs69', 162)" class="i">ewmaWeightedCovar</span> <span class="o">=</span> 
    <span onmouseout="hideTip(event, 'fs68', 163)" onmouseover="showTip(event, 'fs68', 163)" class="i">ewmaCovar</span>      
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs14', 164)" onmouseover="showTip(event, 'fs14', 164)" class="t">Series</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs70', 165)" onmouseover="showTip(event, 'fs70', 165)" class="f">scanValues</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs71', 166)" onmouseover="showTip(event, 'fs71', 166)" class="i">lastweightedCovar</span> <span onmouseout="hideTip(event, 'fs72', 167)" onmouseover="showTip(event, 'fs72', 167)" class="i">thisCovar</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs52', 168)" onmouseover="showTip(event, 'fs52', 168)" class="i">uncCorrelLambda</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs71', 169)" onmouseover="showTip(event, 'fs71', 169)" class="i">lastweightedCovar</span> <span class="o">+</span> (<span class="n">1.0</span> <span class="o">-</span> <span onmouseout="hideTip(event, 'fs52', 170)" onmouseover="showTip(event, 'fs52', 170)" class="i">uncCorrelLambda</span>) <span class="o">*</span> <span onmouseout="hideTip(event, 'fs72', 171)" onmouseover="showTip(event, 'fs72', 171)" class="i">thisCovar</span> ) <span onmouseout="hideTip(event, 'fs54', 172)" onmouseover="showTip(event, 'fs54', 172)" class="i">uncCovarInit</span>
    
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs73', 173)" onmouseover="showTip(event, 'fs73', 173)" class="i">ewmaVarLH</span> <span class="o">=</span> 
    <span onmouseout="hideTip(event, 'fs66', 174)" onmouseover="showTip(event, 'fs66', 174)" class="i">seriesLHMinusMu</span>      
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs14', 175)" onmouseover="showTip(event, 'fs14', 175)" class="t">Series</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs70', 176)" onmouseover="showTip(event, 'fs70', 176)" class="f">scanValues</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs74', 177)" onmouseover="showTip(event, 'fs74', 177)" class="i">lastweightedVar</span> <span onmouseout="hideTip(event, 'fs75', 178)" onmouseover="showTip(event, 'fs75', 178)" class="i">thisVar</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs52', 179)" onmouseover="showTip(event, 'fs52', 179)" class="i">uncCorrelLambda</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs74', 180)" onmouseover="showTip(event, 'fs74', 180)" class="i">lastweightedVar</span> <span class="o">+</span> (<span class="n">1.0</span> <span class="o">-</span> <span onmouseout="hideTip(event, 'fs52', 181)" onmouseover="showTip(event, 'fs52', 181)" class="i">uncCorrelLambda</span>) <span class="o">*</span> <span onmouseout="hideTip(event, 'fs75', 182)" onmouseover="showTip(event, 'fs75', 182)" class="i">thisVar</span> <span class="o">**</span> <span class="n">2.0</span> ) <span onmouseout="hideTip(event, 'fs53', 183)" onmouseover="showTip(event, 'fs53', 183)" class="i">uncVarInit</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs76', 184)" onmouseover="showTip(event, 'fs76', 184)" class="i">ewmaVarRH</span> <span class="o">=</span> 
    <span onmouseout="hideTip(event, 'fs67', 185)" onmouseover="showTip(event, 'fs67', 185)" class="i">seriesRHMinusMu</span>      
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs14', 186)" onmouseover="showTip(event, 'fs14', 186)" class="t">Series</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs70', 187)" onmouseover="showTip(event, 'fs70', 187)" class="f">scanValues</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs74', 188)" onmouseover="showTip(event, 'fs74', 188)" class="i">lastweightedVar</span> <span onmouseout="hideTip(event, 'fs75', 189)" onmouseover="showTip(event, 'fs75', 189)" class="i">thisVar</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs52', 190)" onmouseover="showTip(event, 'fs52', 190)" class="i">uncCorrelLambda</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs74', 191)" onmouseover="showTip(event, 'fs74', 191)" class="i">lastweightedVar</span> <span class="o">+</span> (<span class="n">1.0</span> <span class="o">-</span> <span onmouseout="hideTip(event, 'fs52', 192)" onmouseover="showTip(event, 'fs52', 192)" class="i">uncCorrelLambda</span>) <span class="o">*</span> <span onmouseout="hideTip(event, 'fs75', 193)" onmouseover="showTip(event, 'fs75', 193)" class="i">thisVar</span> <span class="o">**</span> <span class="n">2.0</span> ) <span onmouseout="hideTip(event, 'fs53', 194)" onmouseover="showTip(event, 'fs53', 194)" class="i">uncVarInit</span>
</code></pre></td>
</tr>
</table>
<p>We can now calculate the correlation based on weighted covariance and variance.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs77', 195)" onmouseover="showTip(event, 'fs77', 195)" class="i">ewmaCorrel</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs69', 196)" onmouseover="showTip(event, 'fs69', 196)" class="i">ewmaWeightedCovar</span> <span class="o">/</span> (<span onmouseout="hideTip(event, 'fs73', 197)" onmouseover="showTip(event, 'fs73', 197)" class="i">ewmaVarLH</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs76', 198)" onmouseover="showTip(event, 'fs76', 198)" class="i">ewmaVarRH</span>) <span class="o">**</span> <span class="n">0.5</span>

<span class="c">// finally, the contribution to the current unconditional correlation matrix for this pair is the ewmaCorrel value at the calibration date</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs78', 199)" onmouseover="showTip(event, 'fs78', 199)" class="i">finalUnconditionalCorrelation</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs77', 200)" onmouseover="showTip(event, 'fs77', 200)" class="i">ewmaCorrel</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs79', 201)" onmouseover="showTip(event, 'fs79', 201)" class="f">Get</span>(<span onmouseout="hideTip(event, 'fs55', 202)" onmouseover="showTip(event, 'fs55', 202)" class="i">oldCalibrationDate</span>)
</code></pre></td>
</tr>
</table>
<h1>Refactoring Into Pair functions</h1>
<p>For mostly my own benifit, I want to see how we can use this code to calculate an entire correlation matrix.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
<span class="l">22: </span>
<span class="l">23: </span>
<span class="l">24: </span>
<span class="l">25: </span>
<span class="l">26: </span>
<span class="l">27: </span>
<span class="l">28: </span>
<span class="l">29: </span>
<span class="l">30: </span>
<span class="l">31: </span>
<span class="l">32: </span>
<span class="l">33: </span>
<span class="l">34: </span>
<span class="l">35: </span>
<span class="l">36: </span>
<span class="l">37: </span>
<span class="l">38: </span>
<span class="l">39: </span>
<span class="l">40: </span>
<span class="l">41: </span>
<span class="l">42: </span>
<span class="l">43: </span>
<span class="l">44: </span>
<span class="l">45: </span>
<span class="l">46: </span>
<span class="l">47: </span>
<span class="l">48: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="c">// Refactor into a function that returns correlation from a pair (correlation with itself is 1.0)</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs80', 203)" onmouseover="showTip(event, 'fs80', 203)" class="f">get10YCorrelFromPair</span> (<span onmouseout="hideTip(event, 'fs81', 204)" onmouseover="showTip(event, 'fs81', 204)" class="i">calibrationDate</span><span class="o">:</span> <span onmouseout="hideTip(event, 'fs10', 205)" onmouseover="showTip(event, 'fs10', 205)" class="t">DateTime</span>) <span onmouseout="hideTip(event, 'fs82', 206)" onmouseover="showTip(event, 'fs82', 206)" class="i">assetLH</span> <span onmouseout="hideTip(event, 'fs83', 207)" onmouseover="showTip(event, 'fs83', 207)" class="i">assetRH</span> <span class="o">=</span> 
    
    <span class="k">match</span> <span onmouseout="hideTip(event, 'fs82', 208)" onmouseover="showTip(event, 'fs82', 208)" class="i">assetLH</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs83', 209)" onmouseover="showTip(event, 'fs83', 209)" class="i">assetRH</span> <span class="k">with</span>
    | <span class="k">true</span> <span class="k">-&gt;</span> <span class="n">1.0</span>
    | _ <span class="k">-&gt;</span> 
            <span class="k">let</span> <span onmouseout="hideTip(event, 'fs84', 210)" onmouseover="showTip(event, 'fs84', 210)" class="i">exampleReturnDataFrame</span> <span class="o">=</span> [ 
                  <span onmouseout="hideTip(event, 'fs82', 211)" onmouseover="showTip(event, 'fs82', 211)" class="i">assetLH</span> <span class="o">=&gt;</span> <span onmouseout="hideTip(event, 'fs23', 212)" onmouseover="showTip(event, 'fs23', 212)" class="f">returnXSReturnSeries</span> <span onmouseout="hideTip(event, 'fs82', 213)" onmouseover="showTip(event, 'fs82', 213)" class="i">assetLH</span>;  
                  <span onmouseout="hideTip(event, 'fs83', 214)" onmouseover="showTip(event, 'fs83', 214)" class="i">assetRH</span> <span class="o">=&gt;</span> <span onmouseout="hideTip(event, 'fs23', 215)" onmouseover="showTip(event, 'fs23', 215)" class="f">returnXSReturnSeries</span> <span onmouseout="hideTip(event, 'fs83', 216)" onmouseover="showTip(event, 'fs83', 216)" class="i">assetRH</span>] <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs9', 217)" onmouseover="showTip(event, 'fs9', 217)" class="t">Frame</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs26', 218)" onmouseover="showTip(event, 'fs26', 218)" class="f">ofColumns</span>
    
            <span class="k">let</span> <span onmouseout="hideTip(event, 'fs85', 219)" onmouseover="showTip(event, 'fs85', 219)" class="i">tenYearsAgo</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs81', 220)" onmouseover="showTip(event, 'fs81', 220)" class="i">calibrationDate</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs29', 221)" onmouseover="showTip(event, 'fs29', 221)" class="f">AddYears</span>(<span class="o">-</span><span class="n">10</span>)    
            <span class="k">let</span> <span onmouseout="hideTip(event, 'fs86', 222)" onmouseover="showTip(event, 'fs86', 222)" class="i">exampleHist10YReturns</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs84', 223)" onmouseover="showTip(event, 'fs84', 223)" class="i">exampleReturnDataFrame</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs9', 224)" onmouseover="showTip(event, 'fs9', 224)" class="t">Frame</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs32', 225)" onmouseover="showTip(event, 'fs32', 225)" class="f">filterRows</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs16', 226)" onmouseover="showTip(event, 'fs16', 226)" class="i">k</span> <span onmouseout="hideTip(event, 'fs33', 227)" onmouseover="showTip(event, 'fs33', 227)" class="i">v</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs16', 228)" onmouseover="showTip(event, 'fs16', 228)" class="i">k</span> <span class="o">&gt;</span> <span onmouseout="hideTip(event, 'fs85', 229)" onmouseover="showTip(event, 'fs85', 229)" class="i">tenYearsAgo</span> <span class="o">&amp;&amp;</span> <span onmouseout="hideTip(event, 'fs16', 230)" onmouseover="showTip(event, 'fs16', 230)" class="i">k</span> <span class="o">&lt;=</span> <span onmouseout="hideTip(event, 'fs81', 231)" onmouseover="showTip(event, 'fs81', 231)" class="i">calibrationDate</span>)

            <span class="k">let</span> <span onmouseout="hideTip(event, 'fs87', 232)" onmouseover="showTip(event, 'fs87', 232)" class="i">myX</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs86', 233)" onmouseover="showTip(event, 'fs86', 233)" class="i">exampleHist10YReturns</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs13', 234)" onmouseover="showTip(event, 'fs13', 234)" class="f">GetColumn</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs19', 235)" onmouseover="showTip(event, 'fs19', 235)" class="t">float</span><span class="o">&gt;</span>(<span onmouseout="hideTip(event, 'fs82', 236)" onmouseover="showTip(event, 'fs82', 236)" class="i">assetLH</span>)<span class="o">.</span><span class="i">ValuesAll</span>
            <span class="k">let</span> <span onmouseout="hideTip(event, 'fs88', 237)" onmouseover="showTip(event, 'fs88', 237)" class="i">myY</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs86', 238)" onmouseover="showTip(event, 'fs86', 238)" class="i">exampleHist10YReturns</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs13', 239)" onmouseover="showTip(event, 'fs13', 239)" class="f">GetColumn</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs19', 240)" onmouseover="showTip(event, 'fs19', 240)" class="t">float</span><span class="o">&gt;</span>(<span onmouseout="hideTip(event, 'fs83', 241)" onmouseover="showTip(event, 'fs83', 241)" class="i">assetRH</span>)<span class="o">.</span><span class="i">ValuesAll</span>    

            <span class="k">let</span> <span onmouseout="hideTip(event, 'fs89', 242)" onmouseover="showTip(event, 'fs89', 242)" class="i">myCorrelXY</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs38', 243)" onmouseover="showTip(event, 'fs38', 243)" class="i">Statistics</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs39', 244)" onmouseover="showTip(event, 'fs39', 244)" class="t">Correlation</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs40', 245)" onmouseover="showTip(event, 'fs40', 245)" class="f">Pearson</span>(<span onmouseout="hideTip(event, 'fs87', 246)" onmouseover="showTip(event, 'fs87', 246)" class="i">myX</span>, <span onmouseout="hideTip(event, 'fs88', 247)" onmouseover="showTip(event, 'fs88', 247)" class="i">myY</span>)

            <span onmouseout="hideTip(event, 'fs89', 248)" onmouseover="showTip(event, 'fs89', 248)" class="i">myCorrelXY</span>

<span class="c">// This should return the same values as above</span>
<span onmouseout="hideTip(event, 'fs80', 249)" onmouseover="showTip(event, 'fs80', 249)" class="f">get10YCorrelFromPair</span> <span onmouseout="hideTip(event, 'fs27', 250)" onmouseover="showTip(event, 'fs27', 250)" class="i">calibrationDate</span> <span class="s">&quot;ASX_200_A_REIT&quot;</span> <span class="s">&quot;ASX_200_BANKS&quot;</span> 
<span onmouseout="hideTip(event, 'fs80', 251)" onmouseover="showTip(event, 'fs80', 251)" class="f">get10YCorrelFromPair</span> <span onmouseout="hideTip(event, 'fs27', 252)" onmouseover="showTip(event, 'fs27', 252)" class="i">calibrationDate</span> <span class="s">&quot;ASX_200_A_REIT&quot;</span> <span class="s">&quot;China_25&quot;</span>  
<span onmouseout="hideTip(event, 'fs80', 253)" onmouseover="showTip(event, 'fs80', 253)" class="f">get10YCorrelFromPair</span> <span onmouseout="hideTip(event, 'fs27', 254)" onmouseover="showTip(event, 'fs27', 254)" class="i">calibrationDate</span> <span class="s">&quot;China_25&quot;</span> <span class="s">&quot;China_25&quot;</span> 

<span class="c">// We can now define a List of all assets we wish to include in the correlation matrix</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs90', 255)" onmouseover="showTip(event, 'fs90', 255)" class="i">assetList</span> <span class="o">=</span> [<span class="s">&quot;ASX_200_A_REIT&quot;</span>;<span class="s">&quot;ASX_200_BANKS&quot;</span>;<span class="s">&quot;China_25&quot;</span>] 

<span class="c">// We will create a record type to hold all the info about a &quot;matrix&quot;</span>
<span class="k">type</span> <span onmouseout="hideTip(event, 'fs91', 256)" onmouseover="showTip(event, 'fs91', 256)" class="t">MatrixDescription</span> <span class="o">=</span> {<span onmouseout="hideTip(event, 'fs92', 257)" onmouseover="showTip(event, 'fs92', 257)" class="i">assets</span><span class="o">:</span> <span onmouseout="hideTip(event, 'fs93', 258)" onmouseover="showTip(event, 'fs93', 258)" class="t">List</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs11', 259)" onmouseover="showTip(event, 'fs11', 259)" class="t">string</span><span class="o">&gt;</span>; <span onmouseout="hideTip(event, 'fs94', 260)" onmouseover="showTip(event, 'fs94', 260)" class="i">matrix</span><span class="o">:</span> <span onmouseout="hideTip(event, 'fs48', 261)" onmouseover="showTip(event, 'fs48', 261)" class="t">Matrix</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs19', 262)" onmouseover="showTip(event, 'fs19', 262)" class="t">float</span><span class="o">&gt;</span>}

<span class="c">// We want to yield all pairs of assets, and calculate the correlation between them</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs95', 263)" onmouseover="showTip(event, 'fs95', 263)" class="f">getCorrelMatrix</span> <span onmouseout="hideTip(event, 'fs96', 264)" onmouseover="showTip(event, 'fs96', 264)" class="i">calibrationDate</span> <span onmouseout="hideTip(event, 'fs97', 265)" onmouseover="showTip(event, 'fs97', 265)" class="f">funCorrelMethod</span> <span onmouseout="hideTip(event, 'fs98', 266)" onmouseover="showTip(event, 'fs98', 266)" class="i">assetList</span> <span class="o">=</span> 

    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs99', 267)" onmouseover="showTip(event, 'fs99', 267)" class="f">getThis10YCorrelFromPair</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs97', 268)" onmouseover="showTip(event, 'fs97', 268)" class="f">funCorrelMethod</span> <span onmouseout="hideTip(event, 'fs96', 269)" onmouseover="showTip(event, 'fs96', 269)" class="i">calibrationDate</span> 
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs100', 270)" onmouseover="showTip(event, 'fs100', 270)" class="i">indexedAssetList</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs98', 271)" onmouseover="showTip(event, 'fs98', 271)" class="i">assetList</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs93', 272)" onmouseover="showTip(event, 'fs93', 272)" class="t">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs101', 273)" onmouseover="showTip(event, 'fs101', 273)" class="f">zip</span> [<span class="n">0..</span><span onmouseout="hideTip(event, 'fs98', 274)" onmouseover="showTip(event, 'fs98', 274)" class="i">assetList</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs102', 275)" onmouseover="showTip(event, 'fs102', 275)" class="i">Length</span><span class="o">-</span><span class="n">1</span>]

    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs103', 276)" onmouseover="showTip(event, 'fs103', 276)" class="i">flatMatrix</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs104', 277)" onmouseover="showTip(event, 'fs104', 277)" class="i">seq</span> { <span class="k">for</span> <span onmouseout="hideTip(event, 'fs105', 278)" onmouseover="showTip(event, 'fs105', 278)" class="i">keyLH</span>, <span onmouseout="hideTip(event, 'fs82', 279)" onmouseover="showTip(event, 'fs82', 279)" class="i">assetLH</span> <span class="k">in</span> <span onmouseout="hideTip(event, 'fs100', 280)" onmouseover="showTip(event, 'fs100', 280)" class="i">indexedAssetList</span> <span class="k">do</span>
                            <span class="k">for</span> <span onmouseout="hideTip(event, 'fs106', 281)" onmouseover="showTip(event, 'fs106', 281)" class="i">keyRH</span>, <span onmouseout="hideTip(event, 'fs83', 282)" onmouseover="showTip(event, 'fs83', 282)" class="i">assetRH</span> <span class="k">in</span> <span onmouseout="hideTip(event, 'fs100', 283)" onmouseover="showTip(event, 'fs100', 283)" class="i">indexedAssetList</span> <span class="k">do</span>
                                <span class="k">yield</span> (<span onmouseout="hideTip(event, 'fs105', 284)" onmouseover="showTip(event, 'fs105', 284)" class="i">keyLH</span>, <span class="i">keyRH</span>, <span onmouseout="hideTip(event, 'fs99', 285)" onmouseover="showTip(event, 'fs99', 285)" class="f">getThis10YCorrelFromPair</span> <span onmouseout="hideTip(event, 'fs82', 286)" onmouseover="showTip(event, 'fs82', 286)" class="i">assetLH</span> <span onmouseout="hideTip(event, 'fs83', 287)" onmouseover="showTip(event, 'fs83', 287)" class="i">assetRH</span>)
                         }
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs107', 288)" onmouseover="showTip(event, 'fs107', 288)" class="i">denseMatrix</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs108', 289)" onmouseover="showTip(event, 'fs108', 289)" class="t">DenseMatrix</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs109', 290)" onmouseover="showTip(event, 'fs109', 290)" class="f">ofSeqi</span> <span onmouseout="hideTip(event, 'fs98', 291)" onmouseover="showTip(event, 'fs98', 291)" class="i">assetList</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs102', 292)" onmouseover="showTip(event, 'fs102', 292)" class="i">Length</span> <span onmouseout="hideTip(event, 'fs98', 293)" onmouseover="showTip(event, 'fs98', 293)" class="i">assetList</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs102', 294)" onmouseover="showTip(event, 'fs102', 294)" class="i">Length</span> <span onmouseout="hideTip(event, 'fs103', 295)" onmouseover="showTip(event, 'fs103', 295)" class="i">flatMatrix</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs110', 296)" onmouseover="showTip(event, 'fs110', 296)" class="i">result</span> <span class="o">=</span> {<span class="i">assets</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs98', 297)" onmouseover="showTip(event, 'fs98', 297)" class="i">assetList</span>; <span onmouseout="hideTip(event, 'fs45', 298)" onmouseover="showTip(event, 'fs45', 298)" class="i">matrix</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs107', 299)" onmouseover="showTip(event, 'fs107', 299)" class="i">denseMatrix</span>}
    <span onmouseout="hideTip(event, 'fs110', 300)" onmouseover="showTip(event, 'fs110', 300)" class="i">result</span>
                    <span class="c">//yield (assetLH, assetRH, getThis10YCorrelFromPair assetLH assetRH)</span>
      

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs111', 301)" onmouseover="showTip(event, 'fs111', 301)" class="i">test10YMatrix</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs95', 302)" onmouseover="showTip(event, 'fs95', 302)" class="f">getCorrelMatrix</span> <span onmouseout="hideTip(event, 'fs27', 303)" onmouseover="showTip(event, 'fs27', 303)" class="i">calibrationDate</span> <span onmouseout="hideTip(event, 'fs80', 304)" onmouseover="showTip(event, 'fs80', 304)" class="f">get10YCorrelFromPair</span> <span onmouseout="hideTip(event, 'fs90', 305)" onmouseover="showTip(event, 'fs90', 305)" class="i">assetList</span>
</code></pre></td>
</tr>
</table>
<p>We can repeat the same approach for the unconditional correlation</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
<span class="l">22: </span>
<span class="l">23: </span>
<span class="l">24: </span>
<span class="l">25: </span>
<span class="l">26: </span>
<span class="l">27: </span>
<span class="l">28: </span>
<span class="l">29: </span>
<span class="l">30: </span>
<span class="l">31: </span>
<span class="l">32: </span>
<span class="l">33: </span>
<span class="l">34: </span>
<span class="l">35: </span>
<span class="l">36: </span>
<span class="l">37: </span>
<span class="l">38: </span>
<span class="l">39: </span>
<span class="l">40: </span>
<span class="l">41: </span>
<span class="l">42: </span>
<span class="l">43: </span>
<span class="l">44: </span>
<span class="l">45: </span>
<span class="l">46: </span>
<span class="l">47: </span>
<span class="l">48: </span>
<span class="l">49: </span>
<span class="l">50: </span>
<span class="l">51: </span>
<span class="l">52: </span>
<span class="l">53: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs112', 306)" onmouseover="showTip(event, 'fs112', 306)" class="f">getUncCorrelFromPair</span> <span onmouseout="hideTip(event, 'fs113', 307)" onmouseover="showTip(event, 'fs113', 307)" class="i">lambda</span> <span onmouseout="hideTip(event, 'fs114', 308)" onmouseover="showTip(event, 'fs114', 308)" class="i">uncVarInit</span> <span onmouseout="hideTip(event, 'fs115', 309)" onmouseover="showTip(event, 'fs115', 309)" class="i">covarScale</span> (<span onmouseout="hideTip(event, 'fs81', 310)" onmouseover="showTip(event, 'fs81', 310)" class="i">calibrationDate</span><span class="o">:</span> <span onmouseout="hideTip(event, 'fs10', 311)" onmouseover="showTip(event, 'fs10', 311)" class="t">DateTime</span>) <span onmouseout="hideTip(event, 'fs82', 312)" onmouseover="showTip(event, 'fs82', 312)" class="i">assetLH</span> <span onmouseout="hideTip(event, 'fs83', 313)" onmouseover="showTip(event, 'fs83', 313)" class="i">assetRH</span> <span class="o">=</span>
    
    <span class="k">match</span> <span onmouseout="hideTip(event, 'fs82', 314)" onmouseover="showTip(event, 'fs82', 314)" class="i">assetLH</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs83', 315)" onmouseover="showTip(event, 'fs83', 315)" class="i">assetRH</span> <span class="k">with</span>
    | <span class="k">true</span> <span class="k">-&gt;</span> <span class="n">1.0</span>
    | _ <span class="k">-&gt;</span> 
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs116', 316)" onmouseover="showTip(event, 'fs116', 316)" class="i">seriesLH</span> <span class="o">=</span>  (<span onmouseout="hideTip(event, 'fs23', 317)" onmouseover="showTip(event, 'fs23', 317)" class="f">returnXSReturnSeries</span> <span onmouseout="hideTip(event, 'fs82', 318)" onmouseover="showTip(event, 'fs82', 318)" class="i">assetLH</span>)<span class="o">.</span><span class="f">EndAt</span>(<span onmouseout="hideTip(event, 'fs81', 319)" onmouseover="showTip(event, 'fs81', 319)" class="i">calibrationDate</span>)
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs117', 320)" onmouseover="showTip(event, 'fs117', 320)" class="i">seriesRH</span> <span class="o">=</span> (<span onmouseout="hideTip(event, 'fs23', 321)" onmouseover="showTip(event, 'fs23', 321)" class="f">returnXSReturnSeries</span> <span onmouseout="hideTip(event, 'fs83', 322)" onmouseover="showTip(event, 'fs83', 322)" class="i">assetRH</span>)<span class="o">.</span><span class="f">EndAt</span>(<span onmouseout="hideTip(event, 'fs81', 323)" onmouseover="showTip(event, 'fs81', 323)" class="i">calibrationDate</span>)

        <span class="c">// we will need to take the mean value for each series. This is over the entire lifespan of each series.   </span>
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs118', 324)" onmouseover="showTip(event, 'fs118', 324)" class="i">seriesMeanLHS</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs116', 325)" onmouseover="showTip(event, 'fs116', 325)" class="i">seriesLH</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs59', 326)" onmouseover="showTip(event, 'fs59', 326)" class="f">Mean</span>()
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs119', 327)" onmouseover="showTip(event, 'fs119', 327)" class="i">seriesMeanRHS</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs117', 328)" onmouseover="showTip(event, 'fs117', 328)" class="i">seriesRH</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs59', 329)" onmouseover="showTip(event, 'fs59', 329)" class="f">Mean</span>()

        <span class="c">// For the EWMA part of this calculation, we need to start at the first point in time where both series are avaliable</span>
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs120', 330)" onmouseover="showTip(event, 'fs120', 330)" class="i">combinedStartDate</span> <span class="o">=</span> <span class="k">if</span> <span onmouseout="hideTip(event, 'fs116', 331)" onmouseover="showTip(event, 'fs116', 331)" class="i">seriesLH</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs62', 332)" onmouseover="showTip(event, 'fs62', 332)" class="f">FirstKey</span>() <span class="o">&gt;</span> <span onmouseout="hideTip(event, 'fs117', 333)" onmouseover="showTip(event, 'fs117', 333)" class="i">seriesRH</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs62', 334)" onmouseover="showTip(event, 'fs62', 334)" class="f">FirstKey</span>() <span class="k">then</span> <span onmouseout="hideTip(event, 'fs116', 335)" onmouseover="showTip(event, 'fs116', 335)" class="i">seriesLH</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs62', 336)" onmouseover="showTip(event, 'fs62', 336)" class="f">FirstKey</span>() <span class="k">else</span> <span onmouseout="hideTip(event, 'fs117', 337)" onmouseover="showTip(event, 'fs117', 337)" class="i">seriesRH</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs62', 338)" onmouseover="showTip(event, 'fs62', 338)" class="f">FirstKey</span>()

        <span class="c">// we can now truncate the data series, and from now on will be working with series of equal length</span>
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs121', 339)" onmouseover="showTip(event, 'fs121', 339)" class="i">ewmaReturnsLH</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs116', 340)" onmouseover="showTip(event, 'fs116', 340)" class="i">seriesLH</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs64', 341)" onmouseover="showTip(event, 'fs64', 341)" class="f">StartAt</span>(<span onmouseout="hideTip(event, 'fs120', 342)" onmouseover="showTip(event, 'fs120', 342)" class="i">combinedStartDate</span>)
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs122', 343)" onmouseover="showTip(event, 'fs122', 343)" class="i">ewmaReturnsRH</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs117', 344)" onmouseover="showTip(event, 'fs117', 344)" class="i">seriesRH</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs64', 345)" onmouseover="showTip(event, 'fs64', 345)" class="f">StartAt</span>(<span onmouseout="hideTip(event, 'fs120', 346)" onmouseover="showTip(event, 'fs120', 346)" class="i">combinedStartDate</span>)

        <span class="c">// Use the Series mu (over all points) rather than the mean of the ewma period, to calculate the covariance</span>
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs123', 347)" onmouseover="showTip(event, 'fs123', 347)" class="i">seriesLHMinusMu</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs121', 348)" onmouseover="showTip(event, 'fs121', 348)" class="i">ewmaReturnsLH</span> <span class="o">-</span> <span onmouseout="hideTip(event, 'fs118', 349)" onmouseover="showTip(event, 'fs118', 349)" class="i">seriesMeanLHS</span>
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs124', 350)" onmouseover="showTip(event, 'fs124', 350)" class="i">seriesRHMinusMu</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs122', 351)" onmouseover="showTip(event, 'fs122', 351)" class="i">ewmaReturnsRH</span> <span class="o">-</span> <span onmouseout="hideTip(event, 'fs119', 352)" onmouseover="showTip(event, 'fs119', 352)" class="i">seriesMeanRHS</span>
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs125', 353)" onmouseover="showTip(event, 'fs125', 353)" class="i">ewmaCovar</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs123', 354)" onmouseover="showTip(event, 'fs123', 354)" class="i">seriesLHMinusMu</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs124', 355)" onmouseover="showTip(event, 'fs124', 355)" class="i">seriesRHMinusMu</span>

        <span class="c">// EWMA of series</span>
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs126', 356)" onmouseover="showTip(event, 'fs126', 356)" class="i">ewmaWeightedCovar</span> <span class="o">=</span> 
            <span onmouseout="hideTip(event, 'fs125', 357)" onmouseover="showTip(event, 'fs125', 357)" class="i">ewmaCovar</span>      
            <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs14', 358)" onmouseover="showTip(event, 'fs14', 358)" class="t">Series</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs70', 359)" onmouseover="showTip(event, 'fs70', 359)" class="f">scanValues</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs71', 360)" onmouseover="showTip(event, 'fs71', 360)" class="i">lastweightedCovar</span> <span onmouseout="hideTip(event, 'fs72', 361)" onmouseover="showTip(event, 'fs72', 361)" class="i">thisCovar</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs113', 362)" onmouseover="showTip(event, 'fs113', 362)" class="i">lambda</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs71', 363)" onmouseover="showTip(event, 'fs71', 363)" class="i">lastweightedCovar</span> <span class="o">+</span> (<span class="n">1.0</span> <span class="o">-</span> <span onmouseout="hideTip(event, 'fs113', 364)" onmouseover="showTip(event, 'fs113', 364)" class="i">lambda</span>) <span class="o">*</span> <span onmouseout="hideTip(event, 'fs72', 365)" onmouseover="showTip(event, 'fs72', 365)" class="i">thisCovar</span> ) <span onmouseout="hideTip(event, 'fs54', 366)" onmouseover="showTip(event, 'fs54', 366)" class="i">uncCovarInit</span>
    
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs127', 367)" onmouseover="showTip(event, 'fs127', 367)" class="i">ewmaVarLH</span> <span class="o">=</span> 
            <span onmouseout="hideTip(event, 'fs123', 368)" onmouseover="showTip(event, 'fs123', 368)" class="i">seriesLHMinusMu</span>      
            <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs14', 369)" onmouseover="showTip(event, 'fs14', 369)" class="t">Series</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs70', 370)" onmouseover="showTip(event, 'fs70', 370)" class="f">scanValues</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs74', 371)" onmouseover="showTip(event, 'fs74', 371)" class="i">lastweightedVar</span> <span onmouseout="hideTip(event, 'fs75', 372)" onmouseover="showTip(event, 'fs75', 372)" class="i">thisVar</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs113', 373)" onmouseover="showTip(event, 'fs113', 373)" class="i">lambda</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs74', 374)" onmouseover="showTip(event, 'fs74', 374)" class="i">lastweightedVar</span> <span class="o">+</span> (<span class="n">1.0</span> <span class="o">-</span> <span onmouseout="hideTip(event, 'fs113', 375)" onmouseover="showTip(event, 'fs113', 375)" class="i">lambda</span>) <span class="o">*</span> <span onmouseout="hideTip(event, 'fs75', 376)" onmouseover="showTip(event, 'fs75', 376)" class="i">thisVar</span> <span class="o">**</span> <span class="n">2.0</span> ) <span onmouseout="hideTip(event, 'fs114', 377)" onmouseover="showTip(event, 'fs114', 377)" class="i">uncVarInit</span>

        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs128', 378)" onmouseover="showTip(event, 'fs128', 378)" class="i">ewmaVarRH</span> <span class="o">=</span> 
            <span onmouseout="hideTip(event, 'fs124', 379)" onmouseover="showTip(event, 'fs124', 379)" class="i">seriesRHMinusMu</span>      
            <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs14', 380)" onmouseover="showTip(event, 'fs14', 380)" class="t">Series</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs70', 381)" onmouseover="showTip(event, 'fs70', 381)" class="f">scanValues</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs74', 382)" onmouseover="showTip(event, 'fs74', 382)" class="i">lastweightedVar</span> <span onmouseout="hideTip(event, 'fs75', 383)" onmouseover="showTip(event, 'fs75', 383)" class="i">thisVar</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs113', 384)" onmouseover="showTip(event, 'fs113', 384)" class="i">lambda</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs74', 385)" onmouseover="showTip(event, 'fs74', 385)" class="i">lastweightedVar</span> <span class="o">+</span> (<span class="n">1.0</span> <span class="o">-</span> <span onmouseout="hideTip(event, 'fs113', 386)" onmouseover="showTip(event, 'fs113', 386)" class="i">lambda</span>) <span class="o">*</span> <span onmouseout="hideTip(event, 'fs75', 387)" onmouseover="showTip(event, 'fs75', 387)" class="i">thisVar</span> <span class="o">**</span> <span class="n">2.0</span> ) <span onmouseout="hideTip(event, 'fs114', 388)" onmouseover="showTip(event, 'fs114', 388)" class="i">uncVarInit</span>

        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs129', 389)" onmouseover="showTip(event, 'fs129', 389)" class="i">ewmaCorrel</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs126', 390)" onmouseover="showTip(event, 'fs126', 390)" class="i">ewmaWeightedCovar</span> <span class="o">/</span> (<span onmouseout="hideTip(event, 'fs127', 391)" onmouseover="showTip(event, 'fs127', 391)" class="i">ewmaVarLH</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs128', 392)" onmouseover="showTip(event, 'fs128', 392)" class="i">ewmaVarRH</span>) <span class="o">**</span> <span class="n">0.5</span>
        <span class="c">// finally, the contribution to the current unconditional correlation matrix for this pair is the ewmaCorrel value at the calibration date</span>
        <span onmouseout="hideTip(event, 'fs129', 393)" onmouseover="showTip(event, 'fs129', 393)" class="i">ewmaCorrel</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs79', 394)" onmouseover="showTip(event, 'fs79', 394)" class="f">Get</span>(<span onmouseout="hideTip(event, 'fs81', 395)" onmouseover="showTip(event, 'fs81', 395)" class="i">calibrationDate</span>)

<span class="c">// We will (incorrectly) assume that the constants are the same for each pair of assets - in practice we will need more asset info to get the scaling factor out</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs130', 396)" onmouseover="showTip(event, 'fs130', 396)" class="f">defaultGetUncCorrelFromPair</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs112', 397)" onmouseover="showTip(event, 'fs112', 397)" class="f">getUncCorrelFromPair</span> <span class="n">0.99</span> <span class="n">0.005625</span> <span class="n">0.5</span>

<span class="c">// And we can now return the Unc. correlation as above</span>
<span onmouseout="hideTip(event, 'fs130', 398)" onmouseover="showTip(event, 'fs130', 398)" class="f">defaultGetUncCorrelFromPair</span> <span onmouseout="hideTip(event, 'fs55', 399)" onmouseover="showTip(event, 'fs55', 399)" class="i">oldCalibrationDate</span> <span class="s">&quot;E_AUD&quot;</span> <span class="s">&quot;E_HKD&quot;</span>

<span class="c">// Finally, we can use this function to get a &quot;matrix&quot; of Unconditional correlations</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs131', 400)" onmouseover="showTip(event, 'fs131', 400)" class="i">testUncMatrix</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs95', 401)" onmouseover="showTip(event, 'fs95', 401)" class="f">getCorrelMatrix</span> <span onmouseout="hideTip(event, 'fs27', 402)" onmouseover="showTip(event, 'fs27', 402)" class="i">calibrationDate</span> <span onmouseout="hideTip(event, 'fs130', 403)" onmouseover="showTip(event, 'fs130', 403)" class="f">defaultGetUncCorrelFromPair</span> <span onmouseout="hideTip(event, 'fs90', 404)" onmouseover="showTip(event, 'fs90', 404)" class="i">assetList</span>

<span class="c">// A few more test cases</span>
<span onmouseout="hideTip(event, 'fs80', 405)" onmouseover="showTip(event, 'fs80', 405)" class="f">get10YCorrelFromPair</span> <span onmouseout="hideTip(event, 'fs55', 406)" onmouseover="showTip(event, 'fs55', 406)" class="i">oldCalibrationDate</span> <span class="s">&quot;E_GBP&quot;</span> <span class="s">&quot;E_USD&quot;</span> 
<span onmouseout="hideTip(event, 'fs130', 407)" onmouseover="showTip(event, 'fs130', 407)" class="f">defaultGetUncCorrelFromPair</span> <span onmouseout="hideTip(event, 'fs55', 408)" onmouseover="showTip(event, 'fs55', 408)" class="i">oldCalibrationDate</span> <span class="s">&quot;E_GBP&quot;</span> <span class="s">&quot;E_USD&quot;</span>
</code></pre></td>
</tr>
</table>
<h1>Adding E<em>EUR and E</em>SKK</h1>
<p>TO BE DETERMINED IF WE NEED TO DO THIS.</p>
<h1>Portfolio Calculations</h1>
<p>Given the (final) correlation matrix, and the individual asset Unconditional Volatility numbers, we can move on to calculate the Beta, Market Price of Risk and Risk Premium.</p>
<p>In this section, I will show a very small set of assets as an example case. The market numbers here are made up for example purposes.</p>
<p>We must first define our global equity asset portfolio. This comprises of:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
<span class="l">22: </span>
<span class="l">23: </span>
<span class="l">24: </span>
<span class="l">25: </span>
<span class="l">26: </span>
<span class="l">27: </span>
<span class="l">28: </span>
<span class="l">29: </span>
<span class="l">30: </span>
<span class="l">31: </span>
<span class="l">32: </span>
<span class="l">33: </span>
<span class="l">34: </span>
<span class="l">35: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="c">// we have a matrix and a list of assets from above</span>
<span onmouseout="hideTip(event, 'fs131', 409)" onmouseover="showTip(event, 'fs131', 409)" class="i">testUncMatrix</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs94', 410)" onmouseover="showTip(event, 'fs94', 410)" class="i">matrix</span>
<span onmouseout="hideTip(event, 'fs131', 411)" onmouseover="showTip(event, 'fs131', 411)" class="i">testUncMatrix</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs92', 412)" onmouseover="showTip(event, 'fs92', 412)" class="i">assets</span>

<span class="c">// We will need to pull in the Unconditional vols for each asset. Here, we will make up some values for the example</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs132', 413)" onmouseover="showTip(event, 'fs132', 413)" class="i">unconditionalVols</span> <span class="o">=</span> [<span class="n">0.1875</span>;<span class="n">0.165</span>;<span class="n">0.2810</span>]

<span class="c">// The assumed return on the market portfolio</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs133', 414)" onmouseover="showTip(event, 'fs133', 414)" class="i">marketPfReturn</span> <span class="o">=</span> <span class="n">0.04</span>

<span class="c">// The market capitalisation of each asset, at the current calibration date (this will be the latest value in the underlying time series)</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs134', 415)" onmouseover="showTip(event, 'fs134', 415)" class="i">marketCap</span> <span class="o">=</span> [<span class="n">1000.0</span>;<span class="n">200.0</span>;<span class="n">1500.0</span>] <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs93', 416)" onmouseover="showTip(event, 'fs93', 416)" class="t">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs101', 417)" onmouseover="showTip(event, 'fs101', 417)" class="f">zip</span> <span onmouseout="hideTip(event, 'fs90', 418)" onmouseover="showTip(event, 'fs90', 418)" class="i">assetList</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs135', 419)" onmouseover="showTip(event, 'fs135', 419)" class="t">Map</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs136', 420)" onmouseover="showTip(event, 'fs136', 420)" class="f">ofList</span>

<span class="c">// The portfolio weight is the ratio of the asset&#39;s market cap to the global total, multiplied by the 1 or 0 setting value that determines if the asset is in the PF</span>
<span class="c">// We will assume that all of these assets are in the portfolio</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs137', 421)" onmouseover="showTip(event, 'fs137', 421)" class="i">totalMarketCap</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs134', 422)" onmouseover="showTip(event, 'fs134', 422)" class="i">marketCap</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs135', 423)" onmouseover="showTip(event, 'fs135', 423)" class="t">Map</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs138', 424)" onmouseover="showTip(event, 'fs138', 424)" class="f">toList</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs93', 425)" onmouseover="showTip(event, 'fs93', 425)" class="t">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs139', 426)" onmouseover="showTip(event, 'fs139', 426)" class="f">map</span> (<span class="k">fun</span> (<span onmouseout="hideTip(event, 'fs140', 427)" onmouseover="showTip(event, 'fs140', 427)" class="i">k1</span>,<span onmouseout="hideTip(event, 'fs141', 428)" onmouseover="showTip(event, 'fs141', 428)" class="i">v1</span>) <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs141', 429)" onmouseover="showTip(event, 'fs141', 429)" class="i">v1</span>) <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs93', 430)" onmouseover="showTip(event, 'fs93', 430)" class="t">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs142', 431)" onmouseover="showTip(event, 'fs142', 431)" class="f">reduce</span> (<span class="o">+</span>)
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs143', 432)" onmouseover="showTip(event, 'fs143', 432)" class="i">portfolioWeight</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs134', 433)" onmouseover="showTip(event, 'fs134', 433)" class="i">marketCap</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs135', 434)" onmouseover="showTip(event, 'fs135', 434)" class="t">Map</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs144', 435)" onmouseover="showTip(event, 'fs144', 435)" class="f">map</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs145', 436)" onmouseover="showTip(event, 'fs145', 436)" class="i">k</span> <span onmouseout="hideTip(event, 'fs146', 437)" onmouseover="showTip(event, 'fs146', 437)" class="i">v</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs146', 438)" onmouseover="showTip(event, 'fs146', 438)" class="i">v</span> <span class="o">/</span> <span onmouseout="hideTip(event, 'fs137', 439)" onmouseover="showTip(event, 'fs137', 439)" class="i">totalMarketCap</span> )

<span class="c">// To calculate the covariance, we need to use some matrix multiplication</span>
<span class="c">// So, we will convert the weights into a n * 1 matrix (or if you like, a vector)</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs147', 440)" onmouseover="showTip(event, 'fs147', 440)" class="i">pfWeightsMatrix</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs45', 441)" onmouseover="showTip(event, 'fs45', 441)" class="f">matrix</span> [ <span onmouseout="hideTip(event, 'fs90', 442)" onmouseover="showTip(event, 'fs90', 442)" class="i">assetList</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs93', 443)" onmouseover="showTip(event, 'fs93', 443)" class="t">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs139', 444)" onmouseover="showTip(event, 'fs139', 444)" class="f">map</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs12', 445)" onmouseover="showTip(event, 'fs12', 445)" class="i">asset</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs143', 446)" onmouseover="showTip(event, 'fs143', 446)" class="i">portfolioWeight</span><span class="o">.</span>[<span onmouseout="hideTip(event, 'fs12', 447)" onmouseover="showTip(event, 'fs12', 447)" class="i">asset</span>]) ] <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs48', 448)" onmouseover="showTip(event, 'fs48', 448)" class="t">Matrix</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs148', 449)" onmouseover="showTip(event, 'fs148', 449)" class="f">transpose</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs149', 450)" onmouseover="showTip(event, 'fs149', 450)" class="i">pfCovariance</span> <span class="o">=</span> (<span onmouseout="hideTip(event, 'fs131', 451)" onmouseover="showTip(event, 'fs131', 451)" class="i">testUncMatrix</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs94', 452)" onmouseover="showTip(event, 'fs94', 452)" class="i">matrix</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs147', 453)" onmouseover="showTip(event, 'fs147', 453)" class="i">pfWeightsMatrix</span>)<span class="o">.</span><span class="f">Column</span>(<span class="n">0</span>)

<span class="c">// the market portfolio variance is equal to wT * Covar * w</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs150', 454)" onmouseover="showTip(event, 'fs150', 454)" class="i">marketPfVariance</span> <span class="o">=</span> (<span onmouseout="hideTip(event, 'fs147', 455)" onmouseover="showTip(event, 'fs147', 455)" class="i">pfWeightsMatrix</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs151', 456)" onmouseover="showTip(event, 'fs151', 456)" class="f">Transpose</span>() <span class="o">*</span> <span onmouseout="hideTip(event, 'fs131', 457)" onmouseover="showTip(event, 'fs131', 457)" class="i">testUncMatrix</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs94', 458)" onmouseover="showTip(event, 'fs94', 458)" class="i">matrix</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs147', 459)" onmouseover="showTip(event, 'fs147', 459)" class="i">pfWeightsMatrix</span>)<span class="o">.</span>[<span class="n">0</span>,<span class="n">0</span>]

<span class="c">// The market Beta for each asset is equal to covar/porfolioVar</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs152', 460)" onmouseover="showTip(event, 'fs152', 460)" class="i">marketBetas</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs149', 461)" onmouseover="showTip(event, 'fs149', 461)" class="i">pfCovariance</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs50', 462)" onmouseover="showTip(event, 'fs50', 462)" class="t">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs153', 463)" onmouseover="showTip(event, 'fs153', 463)" class="f">map</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs154', 464)" onmouseover="showTip(event, 'fs154', 464)" class="i">cov</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs154', 465)" onmouseover="showTip(event, 'fs154', 465)" class="i">cov</span> <span class="o">/</span> <span onmouseout="hideTip(event, 'fs150', 466)" onmouseover="showTip(event, 'fs150', 466)" class="i">marketPfVariance</span>)

<span class="c">// The risk premia can be calculated, these are equal to beta * pfReturn</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs155', 467)" onmouseover="showTip(event, 'fs155', 467)" class="i">riskPremia</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs152', 468)" onmouseover="showTip(event, 'fs152', 468)" class="i">marketBetas</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs50', 469)" onmouseover="showTip(event, 'fs50', 469)" class="t">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs153', 470)" onmouseover="showTip(event, 'fs153', 470)" class="f">map</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs156', 471)" onmouseover="showTip(event, 'fs156', 471)" class="i">beta</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs156', 472)" onmouseover="showTip(event, 'fs156', 472)" class="i">beta</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs133', 473)" onmouseover="showTip(event, 'fs133', 473)" class="i">marketPfReturn</span>)

<span class="c">// The market price of risk (or Z-score) is equal to the risk premia / unconditional vol</span>
<span onmouseout="hideTip(event, 'fs155', 474)" onmouseover="showTip(event, 'fs155', 474)" class="i">riskPremia</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs50', 475)" onmouseover="showTip(event, 'fs50', 475)" class="t">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs157', 476)" onmouseover="showTip(event, 'fs157', 476)" class="f">toList</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs93', 477)" onmouseover="showTip(event, 'fs93', 477)" class="t">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs101', 478)" onmouseover="showTip(event, 'fs101', 478)" class="f">zip</span> <span onmouseout="hideTip(event, 'fs132', 479)" onmouseover="showTip(event, 'fs132', 479)" class="i">unconditionalVols</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs93', 480)" onmouseover="showTip(event, 'fs93', 480)" class="t">List</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs139', 481)" onmouseover="showTip(event, 'fs139', 481)" class="f">map</span> (<span class="k">fun</span> (<span onmouseout="hideTip(event, 'fs158', 482)" onmouseover="showTip(event, 'fs158', 482)" class="i">uncVol</span>, <span onmouseout="hideTip(event, 'fs159', 483)" onmouseover="showTip(event, 'fs159', 483)" class="i">riskPrem</span>) <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs159', 484)" onmouseover="showTip(event, 'fs159', 484)" class="i">riskPrem</span> <span class="o">/</span> <span onmouseout="hideTip(event, 'fs158', 485)" onmouseover="showTip(event, 'fs158', 485)" class="i">uncVol</span>)
</code></pre></td>
</tr>
</table>
<div class="tip" id="fs1">namespace System</div>
<div class="tip" id="fs2">namespace Deedle</div>
<div class="tip" id="fs3">namespace MathNet</div>
<div class="tip" id="fs4">namespace MathNet.Numerics</div>
<div class="tip" id="fs5">namespace MathNet.Numerics.Statistics</div>
<div class="tip" id="fs6">val root : string<br /><br />Full name: RWTS Mutlivariate Calculations.root</div>
<div class="tip" id="fs7">val ReturnSeries : allSeries:Frame&lt;DateTime,string&gt; -&gt; asset:string -&gt; Series&lt;DateTime,float&gt;<br /><br />Full name: RWTS Mutlivariate Calculations.ReturnSeries</div>
<div class="tip" id="fs8">val allSeries : Frame&lt;DateTime,string&gt;</div>
<div class="tip" id="fs9">Multiple items<br />module Frame<br /><br />from Deedle<br /><br />--------------------<br />type Frame =<br />&#160;&#160;static member ReadReader : reader:IDataReader -&gt; Frame&lt;int,string&gt;<br />&#160;&#160;static member CustomExpanders : Dictionary&lt;Type,Func&lt;obj,seq&lt;string * Type * obj&gt;&gt;&gt;<br />&#160;&#160;static member NonExpandableInterfaces : List&lt;Type&gt;<br />&#160;&#160;static member NonExpandableTypes : HashSet&lt;Type&gt;<br /><br />Full name: Deedle.Frame<br /><br />--------------------<br />type Frame&lt;&#39;TRowKey,&#39;TColumnKey (requires equality and equality)&gt; =<br />&#160;&#160;interface IDynamicMetaObjectProvider<br />&#160;&#160;interface INotifyCollectionChanged<br />&#160;&#160;interface IFsiFormattable<br />&#160;&#160;interface IFrame<br />&#160;&#160;new : names:seq&lt;&#39;TColumnKey&gt; * columns:seq&lt;ISeries&lt;&#39;TRowKey&gt;&gt; -&gt; Frame&lt;&#39;TRowKey,&#39;TColumnKey&gt;<br />&#160;&#160;new : rowIndex:IIndex&lt;&#39;TRowKey&gt; * columnIndex:IIndex&lt;&#39;TColumnKey&gt; * data:IVector&lt;IVector&gt; * indexBuilder:IIndexBuilder * vectorBuilder:IVectorBuilder -&gt; Frame&lt;&#39;TRowKey,&#39;TColumnKey&gt;<br />&#160;&#160;member AddColumn : column:&#39;TColumnKey * series:ISeries&lt;&#39;TRowKey&gt; -&gt; unit<br />&#160;&#160;member AddColumn : column:&#39;TColumnKey * series:seq&lt;&#39;V&gt; -&gt; unit<br />&#160;&#160;member AddColumn : column:&#39;TColumnKey * series:ISeries&lt;&#39;TRowKey&gt; * lookup:Lookup -&gt; unit<br />&#160;&#160;member AddColumn : column:&#39;TColumnKey * series:seq&lt;&#39;V&gt; * lookup:Lookup -&gt; unit<br />&#160;&#160;...<br /><br />Full name: Deedle.Frame&lt;_,_&gt;<br /><br />--------------------<br />new : names:seq&lt;&#39;TColumnKey&gt; * columns:seq&lt;ISeries&lt;&#39;TRowKey&gt;&gt; -&gt; Frame&lt;&#39;TRowKey,&#39;TColumnKey&gt;<br />new : rowIndex:Indices.IIndex&lt;&#39;TRowKey&gt; * columnIndex:Indices.IIndex&lt;&#39;TColumnKey&gt; * data:IVector&lt;IVector&gt; * indexBuilder:Indices.IIndexBuilder * vectorBuilder:Vectors.IVectorBuilder -&gt; Frame&lt;&#39;TRowKey,&#39;TColumnKey&gt;</div>
<div class="tip" id="fs10">Multiple items<br />type DateTime =<br />&#160;&#160;struct<br />&#160;&#160;&#160;&#160;new : ticks:int64 -&gt; DateTime + 10 overloads<br />&#160;&#160;&#160;&#160;member Add : value:TimeSpan -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddDays : value:float -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddHours : value:float -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddMilliseconds : value:float -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddMinutes : value:float -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddMonths : months:int -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddSeconds : value:float -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddTicks : value:int64 -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddYears : value:int -&gt; DateTime<br />&#160;&#160;&#160;&#160;...<br />&#160;&#160;end<br /><br />Full name: System.DateTime<br /><br />--------------------<br />DateTime()<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(ticks: int64) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(ticks: int64, kind: DateTimeKind) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int, calendar: Globalization.Calendar) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int, hour: int, minute: int, second: int) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int, hour: int, minute: int, second: int, kind: DateTimeKind) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int, hour: int, minute: int, second: int, calendar: Globalization.Calendar) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int, hour: int, minute: int, second: int, millisecond: int) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int, hour: int, minute: int, second: int, millisecond: int, kind: DateTimeKind) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em></div>
<div class="tip" id="fs11">Multiple items<br />val string : value:&#39;T -&gt; string<br /><br />Full name: Microsoft.FSharp.Core.Operators.string<br /><br />--------------------<br />type string = String<br /><br />Full name: Microsoft.FSharp.Core.string</div>
<div class="tip" id="fs12">val asset : string</div>
<div class="tip" id="fs13">member Frame.GetColumn : column:&#39;TColumnKey -&gt; Series&lt;&#39;TRowKey,&#39;R&gt;<br />member Frame.GetColumn : column:&#39;TColumnKey * lookup:Lookup -&gt; Series&lt;&#39;TRowKey,&#39;R&gt;</div>
<div class="tip" id="fs14">Multiple items<br />module Series<br /><br />from Deedle<br /><br />--------------------<br />type Series =<br />&#160;&#160;static member ofNullables : values:seq&lt;Nullable&lt;&#39;a0&gt;&gt; -&gt; Series&lt;int,&#39;a0&gt; (requires default constructor and value type and &#39;a0 :&gt; ValueType)<br />&#160;&#160;static member ofObservations : observations:seq&lt;&#39;c * &#39;d&gt; -&gt; Series&lt;&#39;c,&#39;d&gt; (requires equality)<br />&#160;&#160;static member ofOptionalObservations : observations:seq&lt;&#39;K * &#39;a1 option&gt; -&gt; Series&lt;&#39;K,&#39;a1&gt; (requires equality)<br />&#160;&#160;static member ofValues : values:seq&lt;&#39;a&gt; -&gt; Series&lt;int,&#39;a&gt;<br /><br />Full name: Deedle.F# Series extensions.Series<br /><br />--------------------<br />type Series&lt;&#39;K,&#39;V (requires equality)&gt; =<br />&#160;&#160;interface IFsiFormattable<br />&#160;&#160;interface ISeries&lt;&#39;K&gt;<br />&#160;&#160;new : pairs:seq&lt;KeyValuePair&lt;&#39;K,&#39;V&gt;&gt; -&gt; Series&lt;&#39;K,&#39;V&gt;<br />&#160;&#160;new : keys:&#39;K [] * values:&#39;V [] -&gt; Series&lt;&#39;K,&#39;V&gt;<br />&#160;&#160;new : keys:seq&lt;&#39;K&gt; * values:seq&lt;&#39;V&gt; -&gt; Series&lt;&#39;K,&#39;V&gt;<br />&#160;&#160;new : index:IIndex&lt;&#39;K&gt; * vector:IVector&lt;&#39;V&gt; * vectorBuilder:IVectorBuilder * indexBuilder:IIndexBuilder -&gt; Series&lt;&#39;K,&#39;V&gt;<br />&#160;&#160;member After : lowerExclusive:&#39;K -&gt; Series&lt;&#39;K,&#39;V&gt;<br />&#160;&#160;member Aggregate : aggregation:Aggregation&lt;&#39;K&gt; * observationSelector:Func&lt;DataSegment&lt;Series&lt;&#39;K,&#39;V&gt;&gt;,KeyValuePair&lt;&#39;TNewKey,OptionalValue&lt;&#39;R&gt;&gt;&gt; -&gt; Series&lt;&#39;TNewKey,&#39;R&gt; (requires equality)<br />&#160;&#160;member Aggregate : aggregation:Aggregation&lt;&#39;K&gt; * keySelector:Func&lt;DataSegment&lt;Series&lt;&#39;K,&#39;V&gt;&gt;,&#39;TNewKey&gt; * valueSelector:Func&lt;DataSegment&lt;Series&lt;&#39;K,&#39;V&gt;&gt;,OptionalValue&lt;&#39;R&gt;&gt; -&gt; Series&lt;&#39;TNewKey,&#39;R&gt; (requires equality)<br />&#160;&#160;member AsyncMaterialize : unit -&gt; Async&lt;Series&lt;&#39;K,&#39;V&gt;&gt;<br />&#160;&#160;...<br /><br />Full name: Deedle.Series&lt;_,_&gt;<br /><br />--------------------<br />new : pairs:seq&lt;Collections.Generic.KeyValuePair&lt;&#39;K,&#39;V&gt;&gt; -&gt; Series&lt;&#39;K,&#39;V&gt;<br />new : keys:seq&lt;&#39;K&gt; * values:seq&lt;&#39;V&gt; -&gt; Series&lt;&#39;K,&#39;V&gt;<br />new : keys:&#39;K [] * values:&#39;V [] -&gt; Series&lt;&#39;K,&#39;V&gt;<br />new : index:Indices.IIndex&lt;&#39;K&gt; * vector:IVector&lt;&#39;V&gt; * vectorBuilder:Vectors.IVectorBuilder * indexBuilder:Indices.IIndexBuilder -&gt; Series&lt;&#39;K,&#39;V&gt;</div>
<div class="tip" id="fs15">val filter : f:(&#39;K -&gt; &#39;T -&gt; bool) -&gt; series:Series&lt;&#39;K,&#39;T&gt; -&gt; Series&lt;&#39;K,&#39;T&gt; (requires equality)<br /><br />Full name: Deedle.Series.filter</div>
<div class="tip" id="fs16">val k : DateTime</div>
<div class="tip" id="fs17">val v : string</div>
<div class="tip" id="fs18">val map : f:(&#39;K -&gt; &#39;T -&gt; &#39;R) -&gt; series:Series&lt;&#39;K,&#39;T&gt; -&gt; Series&lt;&#39;K,&#39;R&gt; (requires equality)<br /><br />Full name: Deedle.Series.map</div>
<div class="tip" id="fs19">Multiple items<br />val float : value:&#39;T -&gt; float (requires member op_Explicit)<br /><br />Full name: Microsoft.FSharp.Core.Operators.float<br /><br />--------------------<br />type float = Double<br /><br />Full name: Microsoft.FSharp.Core.float<br /><br />--------------------<br />type float&lt;&#39;Measure&gt; = float<br /><br />Full name: Microsoft.FSharp.Core.float&lt;_&gt;</div>
<div class="tip" id="fs20">val XSReturnsfromCSV : Frame&lt;DateTime,string&gt;<br /><br />Full name: RWTS Mutlivariate Calculations.XSReturnsfromCSV</div>
<div class="tip" id="fs21">static member Frame.ReadCsv : path:string * ?hasHeaders:bool * ?inferTypes:bool * ?inferRows:int * ?schema:string * ?separators:string * ?culture:string * ?maxRows:int * ?missingValues:string [] -&gt; Frame&lt;int,string&gt;<br />static member Frame.ReadCsv : stream:IO.Stream * ?hasHeaders:bool * ?inferTypes:bool * ?inferRows:int * ?schema:string * ?separators:string * ?culture:string * ?maxRows:int * ?missingValues:string [] -&gt; Frame&lt;int,string&gt;<br />static member Frame.ReadCsv : reader:IO.TextReader * ?hasHeaders:bool * ?inferTypes:bool * ?inferRows:int * ?schema:string * ?separators:string * ?culture:string * ?maxRows:int * ?missingValues:string [] -&gt; Frame&lt;int,string&gt;<br />static member Frame.ReadCsv : path:string * indexCol:string * ?hasHeaders:bool * ?inferTypes:bool * ?inferRows:int * ?schema:string * ?separators:string * ?culture:string * ?maxRows:int * ?missingValues:string [] -&gt; Frame&lt;&#39;R,string&gt; (requires equality)</div>
<div class="tip" id="fs22">val sortRowsByKey : frame:Frame&lt;&#39;R,&#39;C&gt; -&gt; Frame&lt;&#39;R,&#39;C&gt; (requires equality and equality)<br /><br />Full name: Deedle.Frame.sortRowsByKey</div>
<div class="tip" id="fs23">val returnXSReturnSeries : (string -&gt; Series&lt;DateTime,float&gt;)<br /><br />Full name: RWTS Mutlivariate Calculations.returnXSReturnSeries</div>
<div class="tip" id="fs24">val testXSRetSeries : Series&lt;DateTime,float&gt;<br /><br />Full name: RWTS Mutlivariate Calculations.testXSRetSeries</div>
<div class="tip" id="fs25">val exampleReturnDataFrame : Frame&lt;DateTime,string&gt;<br /><br />Full name: RWTS Mutlivariate Calculations.exampleReturnDataFrame</div>
<div class="tip" id="fs26">static member Frame.ofColumns : cols:Series&lt;&#39;C,#ISeries&lt;&#39;R&gt;&gt; -&gt; Frame&lt;&#39;R,&#39;C&gt; (requires equality and equality)<br />static member Frame.ofColumns : cols:seq&lt;&#39;C * #ISeries&lt;&#39;R&gt;&gt; -&gt; Frame&lt;&#39;R,&#39;C&gt; (requires equality and equality)</div>
<div class="tip" id="fs27">val calibrationDate : DateTime<br /><br />Full name: RWTS Mutlivariate Calculations.calibrationDate</div>
<div class="tip" id="fs28">val tenYearsAgo : DateTime<br /><br />Full name: RWTS Mutlivariate Calculations.tenYearsAgo</div>
<div class="tip" id="fs29">DateTime.AddYears(value: int) : DateTime</div>
<div class="tip" id="fs30">member Series.Between : lowerInclusive:&#39;K * upperInclusive:&#39;K -&gt; Series&lt;&#39;K,&#39;V&gt;</div>
<div class="tip" id="fs31">val exampleHist10YReturns : Frame&lt;DateTime,string&gt;<br /><br />Full name: RWTS Mutlivariate Calculations.exampleHist10YReturns</div>
<div class="tip" id="fs32">val filterRows : f:(&#39;R -&gt; ObjectSeries&lt;&#39;C&gt; -&gt; bool) -&gt; frame:Frame&lt;&#39;R,&#39;C&gt; -&gt; Frame&lt;&#39;R,&#39;C&gt; (requires equality and equality)<br /><br />Full name: Deedle.Frame.filterRows</div>
<div class="tip" id="fs33">val v : ObjectSeries&lt;string&gt;</div>
<div class="tip" id="fs34">val myX : seq&lt;float&gt;<br /><br />Full name: RWTS Mutlivariate Calculations.myX</div>
<div class="tip" id="fs35">val myY : seq&lt;float&gt;<br /><br />Full name: RWTS Mutlivariate Calculations.myY</div>
<div class="tip" id="fs36">val myZ : seq&lt;float&gt;<br /><br />Full name: RWTS Mutlivariate Calculations.myZ</div>
<div class="tip" id="fs37">val myCorrelXY : float<br /><br />Full name: RWTS Mutlivariate Calculations.myCorrelXY</div>
<div class="tip" id="fs38">type Statistics =<br />&#160;&#160;static member Covariance : samples1:IEnumerable&lt;float&gt; * samples2:IEnumerable&lt;float&gt; -&gt; float + 2 overloads<br />&#160;&#160;static member EmpiricalCDF : data:IEnumerable&lt;float&gt; * x:float -&gt; float + 2 overloads<br />&#160;&#160;static member EmpiricalCDFFunc : data:IEnumerable&lt;float&gt; -&gt; Func&lt;float, float&gt; + 2 overloads<br />&#160;&#160;static member EmpiricalInvCDF : data:IEnumerable&lt;float&gt; * tau:float -&gt; float + 2 overloads<br />&#160;&#160;static member EmpiricalInvCDFFunc : data:IEnumerable&lt;float&gt; -&gt; Func&lt;float, float&gt; + 2 overloads<br />&#160;&#160;static member Entropy : data:IEnumerable&lt;float&gt; -&gt; float + 1 overload<br />&#160;&#160;static member FiveNumberSummary : data:IEnumerable&lt;float&gt; -&gt; float[] + 2 overloads<br />&#160;&#160;static member GeometricMean : data:IEnumerable&lt;float&gt; -&gt; float + 1 overload<br />&#160;&#160;static member HarmonicMean : data:IEnumerable&lt;float&gt; -&gt; float + 1 overload<br />&#160;&#160;static member InterquartileRange : data:IEnumerable&lt;float&gt; -&gt; float + 2 overloads<br />&#160;&#160;...<br /><br />Full name: MathNet.Numerics.Statistics.Statistics</div>
<div class="tip" id="fs39">type Correlation =<br />&#160;&#160;static member Pearson : dataA:IEnumerable&lt;float&gt; * dataB:IEnumerable&lt;float&gt; -&gt; float<br />&#160;&#160;static member PearsonMatrix : [&lt;ParamArray&gt;] vectors:float[][] -&gt; Matrix&lt;float&gt; + 1 overload<br />&#160;&#160;static member Spearman : dataA:IEnumerable&lt;float&gt; * dataB:IEnumerable&lt;float&gt; -&gt; float<br />&#160;&#160;static member SpearmanMatrix : [&lt;ParamArray&gt;] vectors:float[][] -&gt; Matrix&lt;float&gt; + 1 overload<br />&#160;&#160;static member WeightedPearson : dataA:IEnumerable&lt;float&gt; * dataB:IEnumerable&lt;float&gt; * weights:IEnumerable&lt;float&gt; -&gt; float<br /><br />Full name: MathNet.Numerics.Statistics.Correlation</div>
<div class="tip" id="fs40">Correlation.Pearson(dataA: Collections.Generic.IEnumerable&lt;float&gt;, dataB: Collections.Generic.IEnumerable&lt;float&gt;) : float</div>
<div class="tip" id="fs41">val myCorrelXZ : float<br /><br />Full name: RWTS Mutlivariate Calculations.myCorrelXZ</div>
<div class="tip" id="fs42">val myCorrelYZ : float<br /><br />Full name: RWTS Mutlivariate Calculations.myCorrelYZ</div>
<div class="tip" id="fs43">namespace MathNet.Numerics.LinearAlgebra</div>
<div class="tip" id="fs44">val correlMatrix : Matrix&lt;float&gt;<br /><br />Full name: RWTS Mutlivariate Calculations.correlMatrix</div>
<div class="tip" id="fs45">val matrix : lst:&#39;T list list -&gt; Matrix&lt;&#39;T&gt; (requires default constructor and value type and &#39;T :&gt; IEquatable&lt;&#39;T&gt; and &#39;T :&gt; IFormattable and &#39;T :&gt; ValueType)<br /><br />Full name: MathNet.Numerics.LinearAlgebra.MatrixExtensions.matrix</div>
<div class="tip" id="fs46">val isPSD : matrix:Matrix&lt;float&gt; -&gt; bool<br /><br />Full name: RWTS Mutlivariate Calculations.isPSD</div>
<div class="tip" id="fs47">val matrix : Matrix&lt;float&gt;</div>
<div class="tip" id="fs48">type Matrix&lt;&#39;T (requires default constructor and value type and &#39;T :&gt; IEquatable&lt;&#39;T&gt; and &#39;T :&gt; IFormattable and &#39;T :&gt; ValueType)&gt; =<br />&#160;&#160;member Add : scalar:&#39;T -&gt; Matrix&lt;&#39;T&gt; + 3 overloads<br />&#160;&#160;member Append : right:Matrix&lt;&#39;T&gt; -&gt; Matrix&lt;&#39;T&gt; + 1 overload<br />&#160;&#160;member At : row:int * column:int -&gt; &#39;T + 1 overload<br />&#160;&#160;member Cholesky : unit -&gt; Cholesky&lt;&#39;T&gt;<br />&#160;&#160;member Clear : unit -&gt; unit<br />&#160;&#160;member ClearColumn : columnIndex:int -&gt; unit<br />&#160;&#160;member ClearColumns : [&lt;ParamArray&gt;] columnIndices:int[] -&gt; unit<br />&#160;&#160;member ClearRow : rowIndex:int -&gt; unit<br />&#160;&#160;member ClearRows : [&lt;ParamArray&gt;] rowIndices:int[] -&gt; unit<br />&#160;&#160;member ClearSubMatrix : rowIndex:int * rowCount:int * columnIndex:int * columnCount:int -&gt; unit<br />&#160;&#160;...<br /><br />Full name: MathNet.Numerics.LinearAlgebra.Matrix&lt;_&gt;</div>
<div class="tip" id="fs49">Matrix.Evd(?symmetricity: Symmetricity) : Factorization.Evd&lt;float&gt;</div>
<div class="tip" id="fs50">module Seq<br /><br />from Microsoft.FSharp.Collections</div>
<div class="tip" id="fs51">val min : source:seq&lt;&#39;T&gt; -&gt; &#39;T (requires comparison)<br /><br />Full name: Microsoft.FSharp.Collections.Seq.min</div>
<div class="tip" id="fs52">val uncCorrelLambda : float<br /><br />Full name: RWTS Mutlivariate Calculations.uncCorrelLambda</div>
<div class="tip" id="fs53">val uncVarInit : float<br /><br />Full name: RWTS Mutlivariate Calculations.uncVarInit</div>
<div class="tip" id="fs54">val uncCovarInit : float<br /><br />Full name: RWTS Mutlivariate Calculations.uncCovarInit</div>
<div class="tip" id="fs55">val oldCalibrationDate : DateTime<br /><br />Full name: RWTS Mutlivariate Calculations.oldCalibrationDate</div>
<div class="tip" id="fs56">val seriesLH : Series&lt;DateTime,float&gt;<br /><br />Full name: RWTS Mutlivariate Calculations.seriesLH</div>
<div class="tip" id="fs57">val seriesRH : Series&lt;DateTime,float&gt;<br /><br />Full name: RWTS Mutlivariate Calculations.seriesRH</div>
<div class="tip" id="fs58">val seriesMeanLHS : float<br /><br />Full name: RWTS Mutlivariate Calculations.seriesMeanLHS</div>
<div class="tip" id="fs59">static member SeriesStatsExtensions.Mean : series:Series&lt;&#39;K,float&gt; -&gt; float (requires equality)</div>
<div class="tip" id="fs60">val seriesMeanRHS : float<br /><br />Full name: RWTS Mutlivariate Calculations.seriesMeanRHS</div>
<div class="tip" id="fs61">val combinedStartDate : DateTime<br /><br />Full name: RWTS Mutlivariate Calculations.combinedStartDate</div>
<div class="tip" id="fs62">static member SeriesExtensions.FirstKey : series:Series&lt;&#39;K,&#39;V&gt; -&gt; &#39;K (requires equality)</div>
<div class="tip" id="fs63">val ewmaReturnsLH : Series&lt;DateTime,float&gt;<br /><br />Full name: RWTS Mutlivariate Calculations.ewmaReturnsLH</div>
<div class="tip" id="fs64">member Series.StartAt : lowerInclusive:&#39;K -&gt; Series&lt;&#39;K,&#39;V&gt;</div>
<div class="tip" id="fs65">val ewmaReturnsRH : Series&lt;DateTime,float&gt;<br /><br />Full name: RWTS Mutlivariate Calculations.ewmaReturnsRH</div>
<div class="tip" id="fs66">val seriesLHMinusMu : Series&lt;DateTime,float&gt;<br /><br />Full name: RWTS Mutlivariate Calculations.seriesLHMinusMu</div>
<div class="tip" id="fs67">val seriesRHMinusMu : Series&lt;DateTime,float&gt;<br /><br />Full name: RWTS Mutlivariate Calculations.seriesRHMinusMu</div>
<div class="tip" id="fs68">val ewmaCovar : Series&lt;DateTime,float&gt;<br /><br />Full name: RWTS Mutlivariate Calculations.ewmaCovar</div>
<div class="tip" id="fs69">val ewmaWeightedCovar : Series&lt;DateTime,float&gt;<br /><br />Full name: RWTS Mutlivariate Calculations.ewmaWeightedCovar</div>
<div class="tip" id="fs70">val scanValues : foldFunc:(&#39;R -&gt; &#39;T -&gt; &#39;R) -&gt; init:&#39;R -&gt; series:Series&lt;&#39;K,&#39;T&gt; -&gt; Series&lt;&#39;K,&#39;R&gt; (requires equality)<br /><br />Full name: Deedle.Series.scanValues</div>
<div class="tip" id="fs71">val lastweightedCovar : float</div>
<div class="tip" id="fs72">val thisCovar : float</div>
<div class="tip" id="fs73">val ewmaVarLH : Series&lt;DateTime,float&gt;<br /><br />Full name: RWTS Mutlivariate Calculations.ewmaVarLH</div>
<div class="tip" id="fs74">val lastweightedVar : float</div>
<div class="tip" id="fs75">val thisVar : float</div>
<div class="tip" id="fs76">val ewmaVarRH : Series&lt;DateTime,float&gt;<br /><br />Full name: RWTS Mutlivariate Calculations.ewmaVarRH</div>
<div class="tip" id="fs77">val ewmaCorrel : Series&lt;DateTime,float&gt;<br /><br />Full name: RWTS Mutlivariate Calculations.ewmaCorrel</div>
<div class="tip" id="fs78">val finalUnconditionalCorrelation : float<br /><br />Full name: RWTS Mutlivariate Calculations.finalUnconditionalCorrelation</div>
<div class="tip" id="fs79">member Series.Get : key:&#39;K -&gt; &#39;V<br />member Series.Get : key:&#39;K * lookup:Lookup -&gt; &#39;V</div>
<div class="tip" id="fs80">val get10YCorrelFromPair : calibrationDate:DateTime -&gt; assetLH:string -&gt; assetRH:string -&gt; float<br /><br />Full name: RWTS Mutlivariate Calculations.get10YCorrelFromPair</div>
<div class="tip" id="fs81">val calibrationDate : DateTime</div>
<div class="tip" id="fs82">val assetLH : string</div>
<div class="tip" id="fs83">val assetRH : string</div>
<div class="tip" id="fs84">val exampleReturnDataFrame : Frame&lt;DateTime,string&gt;</div>
<div class="tip" id="fs85">val tenYearsAgo : DateTime</div>
<div class="tip" id="fs86">val exampleHist10YReturns : Frame&lt;DateTime,string&gt;</div>
<div class="tip" id="fs87">val myX : seq&lt;float&gt;</div>
<div class="tip" id="fs88">val myY : seq&lt;float&gt;</div>
<div class="tip" id="fs89">val myCorrelXY : float</div>
<div class="tip" id="fs90">val assetList : string list<br /><br />Full name: RWTS Mutlivariate Calculations.assetList</div>
<div class="tip" id="fs91">type MatrixDescription =<br />&#160;&#160;{assets: List&lt;string&gt;;<br />&#160;&#160;&#160;matrix: Matrix&lt;float&gt;;}<br /><br />Full name: RWTS Mutlivariate Calculations.MatrixDescription</div>
<div class="tip" id="fs92">MatrixDescription.assets: List&lt;string&gt;</div>
<div class="tip" id="fs93">Multiple items<br />module List<br /><br />from Microsoft.FSharp.Collections<br /><br />--------------------<br />type List&lt;&#39;T&gt; =<br />&#160;&#160;| ( [] )<br />&#160;&#160;| ( :: ) of Head: &#39;T * Tail: &#39;T list<br />&#160;&#160;interface IEnumerable<br />&#160;&#160;interface IEnumerable&lt;&#39;T&gt;<br />&#160;&#160;member GetSlice : startIndex:int option * endIndex:int option -&gt; &#39;T list<br />&#160;&#160;member Head : &#39;T<br />&#160;&#160;member IsEmpty : bool<br />&#160;&#160;member Item : index:int -&gt; &#39;T with get<br />&#160;&#160;member Length : int<br />&#160;&#160;member Tail : &#39;T list<br />&#160;&#160;static member Cons : head:&#39;T * tail:&#39;T list -&gt; &#39;T list<br />&#160;&#160;static member Empty : &#39;T list<br /><br />Full name: Microsoft.FSharp.Collections.List&lt;_&gt;</div>
<div class="tip" id="fs94">MatrixDescription.matrix: Matrix&lt;float&gt;</div>
<div class="tip" id="fs95">val getCorrelMatrix : calibrationDate:&#39;a -&gt; funCorrelMethod:(&#39;a -&gt; string -&gt; string -&gt; float) -&gt; assetList:string list -&gt; MatrixDescription<br /><br />Full name: RWTS Mutlivariate Calculations.getCorrelMatrix</div>
<div class="tip" id="fs96">val calibrationDate : &#39;a</div>
<div class="tip" id="fs97">val funCorrelMethod : (&#39;a -&gt; string -&gt; string -&gt; float)</div>
<div class="tip" id="fs98">val assetList : string list</div>
<div class="tip" id="fs99">val getThis10YCorrelFromPair : (string -&gt; string -&gt; float)</div>
<div class="tip" id="fs100">val indexedAssetList : (int * string) list</div>
<div class="tip" id="fs101">val zip : list1:&#39;T1 list -&gt; list2:&#39;T2 list -&gt; (&#39;T1 * &#39;T2) list<br /><br />Full name: Microsoft.FSharp.Collections.List.zip</div>
<div class="tip" id="fs102">property List.Length: int</div>
<div class="tip" id="fs103">val flatMatrix : seq&lt;int * int * float&gt;</div>
<div class="tip" id="fs104">Multiple items<br />val seq : sequence:seq&lt;&#39;T&gt; -&gt; seq&lt;&#39;T&gt;<br /><br />Full name: Microsoft.FSharp.Core.Operators.seq<br /><br />--------------------<br />type seq&lt;&#39;T&gt; = Collections.Generic.IEnumerable&lt;&#39;T&gt;<br /><br />Full name: Microsoft.FSharp.Collections.seq&lt;_&gt;</div>
<div class="tip" id="fs105">val keyLH : int</div>
<div class="tip" id="fs106">val keyRH : int</div>
<div class="tip" id="fs107">val denseMatrix : Matrix&lt;float&gt;</div>
<div class="tip" id="fs108">module DenseMatrix<br /><br />from MathNet.Numerics.LinearAlgebra</div>
<div class="tip" id="fs109">val ofSeqi : rows:int -&gt; cols:int -&gt; indexed:#seq&lt;int * int * &#39;T&gt; -&gt; Matrix&lt;&#39;T&gt; (requires default constructor and value type and &#39;T :&gt; IEquatable&lt;&#39;T&gt; and &#39;T :&gt; IFormattable and &#39;T :&gt; ValueType)<br /><br />Full name: MathNet.Numerics.LinearAlgebra.DenseMatrix.ofSeqi</div>
<div class="tip" id="fs110">val result : MatrixDescription</div>
<div class="tip" id="fs111">val test10YMatrix : MatrixDescription<br /><br />Full name: RWTS Mutlivariate Calculations.test10YMatrix</div>
<div class="tip" id="fs112">val getUncCorrelFromPair : lambda:float -&gt; uncVarInit:float -&gt; covarScale:&#39;a -&gt; calibrationDate:DateTime -&gt; assetLH:string -&gt; assetRH:string -&gt; float<br /><br />Full name: RWTS Mutlivariate Calculations.getUncCorrelFromPair</div>
<div class="tip" id="fs113">val lambda : float</div>
<div class="tip" id="fs114">val uncVarInit : float</div>
<div class="tip" id="fs115">val covarScale : &#39;a</div>
<div class="tip" id="fs116">val seriesLH : Series&lt;DateTime,float&gt;</div>
<div class="tip" id="fs117">val seriesRH : Series&lt;DateTime,float&gt;</div>
<div class="tip" id="fs118">val seriesMeanLHS : float</div>
<div class="tip" id="fs119">val seriesMeanRHS : float</div>
<div class="tip" id="fs120">val combinedStartDate : DateTime</div>
<div class="tip" id="fs121">val ewmaReturnsLH : Series&lt;DateTime,float&gt;</div>
<div class="tip" id="fs122">val ewmaReturnsRH : Series&lt;DateTime,float&gt;</div>
<div class="tip" id="fs123">val seriesLHMinusMu : Series&lt;DateTime,float&gt;</div>
<div class="tip" id="fs124">val seriesRHMinusMu : Series&lt;DateTime,float&gt;</div>
<div class="tip" id="fs125">val ewmaCovar : Series&lt;DateTime,float&gt;</div>
<div class="tip" id="fs126">val ewmaWeightedCovar : Series&lt;DateTime,float&gt;</div>
<div class="tip" id="fs127">val ewmaVarLH : Series&lt;DateTime,float&gt;</div>
<div class="tip" id="fs128">val ewmaVarRH : Series&lt;DateTime,float&gt;</div>
<div class="tip" id="fs129">val ewmaCorrel : Series&lt;DateTime,float&gt;</div>
<div class="tip" id="fs130">val defaultGetUncCorrelFromPair : (DateTime -&gt; string -&gt; string -&gt; float)<br /><br />Full name: RWTS Mutlivariate Calculations.defaultGetUncCorrelFromPair</div>
<div class="tip" id="fs131">val testUncMatrix : MatrixDescription<br /><br />Full name: RWTS Mutlivariate Calculations.testUncMatrix</div>
<div class="tip" id="fs132">val unconditionalVols : float list<br /><br />Full name: RWTS Mutlivariate Calculations.unconditionalVols</div>
<div class="tip" id="fs133">val marketPfReturn : float<br /><br />Full name: RWTS Mutlivariate Calculations.marketPfReturn</div>
<div class="tip" id="fs134">val marketCap : Map&lt;string,float&gt;<br /><br />Full name: RWTS Mutlivariate Calculations.marketCap</div>
<div class="tip" id="fs135">Multiple items<br />module Map<br /><br />from Microsoft.FSharp.Collections<br /><br />--------------------<br />type Map&lt;&#39;Key,&#39;Value (requires comparison)&gt; =<br />&#160;&#160;interface IEnumerable<br />&#160;&#160;interface IComparable<br />&#160;&#160;interface IEnumerable&lt;KeyValuePair&lt;&#39;Key,&#39;Value&gt;&gt;<br />&#160;&#160;interface ICollection&lt;KeyValuePair&lt;&#39;Key,&#39;Value&gt;&gt;<br />&#160;&#160;interface IDictionary&lt;&#39;Key,&#39;Value&gt;<br />&#160;&#160;new : elements:seq&lt;&#39;Key * &#39;Value&gt; -&gt; Map&lt;&#39;Key,&#39;Value&gt;<br />&#160;&#160;member Add : key:&#39;Key * value:&#39;Value -&gt; Map&lt;&#39;Key,&#39;Value&gt;<br />&#160;&#160;member ContainsKey : key:&#39;Key -&gt; bool<br />&#160;&#160;override Equals : obj -&gt; bool<br />&#160;&#160;member Remove : key:&#39;Key -&gt; Map&lt;&#39;Key,&#39;Value&gt;<br />&#160;&#160;...<br /><br />Full name: Microsoft.FSharp.Collections.Map&lt;_,_&gt;<br /><br />--------------------<br />new : elements:seq&lt;&#39;Key * &#39;Value&gt; -&gt; Map&lt;&#39;Key,&#39;Value&gt;</div>
<div class="tip" id="fs136">val ofList : elements:(&#39;Key * &#39;T) list -&gt; Map&lt;&#39;Key,&#39;T&gt; (requires comparison)<br /><br />Full name: Microsoft.FSharp.Collections.Map.ofList</div>
<div class="tip" id="fs137">val totalMarketCap : float<br /><br />Full name: RWTS Mutlivariate Calculations.totalMarketCap</div>
<div class="tip" id="fs138">val toList : table:Map&lt;&#39;Key,&#39;T&gt; -&gt; (&#39;Key * &#39;T) list (requires comparison)<br /><br />Full name: Microsoft.FSharp.Collections.Map.toList</div>
<div class="tip" id="fs139">val map : mapping:(&#39;T -&gt; &#39;U) -&gt; list:&#39;T list -&gt; &#39;U list<br /><br />Full name: Microsoft.FSharp.Collections.List.map</div>
<div class="tip" id="fs140">val k1 : string</div>
<div class="tip" id="fs141">val v1 : float</div>
<div class="tip" id="fs142">val reduce : reduction:(&#39;T -&gt; &#39;T -&gt; &#39;T) -&gt; list:&#39;T list -&gt; &#39;T<br /><br />Full name: Microsoft.FSharp.Collections.List.reduce</div>
<div class="tip" id="fs143">val portfolioWeight : Map&lt;string,float&gt;<br /><br />Full name: RWTS Mutlivariate Calculations.portfolioWeight</div>
<div class="tip" id="fs144">val map : mapping:(&#39;Key -&gt; &#39;T -&gt; &#39;U) -&gt; table:Map&lt;&#39;Key,&#39;T&gt; -&gt; Map&lt;&#39;Key,&#39;U&gt; (requires comparison)<br /><br />Full name: Microsoft.FSharp.Collections.Map.map</div>
<div class="tip" id="fs145">val k : string</div>
<div class="tip" id="fs146">val v : float</div>
<div class="tip" id="fs147">val pfWeightsMatrix : Matrix&lt;float&gt;<br /><br />Full name: RWTS Mutlivariate Calculations.pfWeightsMatrix</div>
<div class="tip" id="fs148">val transpose : A:#Matrix&lt;&#39;b&gt; -&gt; Matrix&lt;&#39;b&gt; (requires default constructor and value type and &#39;b :&gt; IEquatable&lt;&#39;b&gt; and &#39;b :&gt; IFormattable and &#39;b :&gt; ValueType)<br /><br />Full name: MathNet.Numerics.LinearAlgebra.Matrix.transpose</div>
<div class="tip" id="fs149">val pfCovariance : Vector&lt;float&gt;<br /><br />Full name: RWTS Mutlivariate Calculations.pfCovariance</div>
<div class="tip" id="fs150">val marketPfVariance : float<br /><br />Full name: RWTS Mutlivariate Calculations.marketPfVariance</div>
<div class="tip" id="fs151">Matrix.Transpose() : Matrix&lt;float&gt;</div>
<div class="tip" id="fs152">val marketBetas : seq&lt;float&gt;<br /><br />Full name: RWTS Mutlivariate Calculations.marketBetas</div>
<div class="tip" id="fs153">val map : mapping:(&#39;T -&gt; &#39;U) -&gt; source:seq&lt;&#39;T&gt; -&gt; seq&lt;&#39;U&gt;<br /><br />Full name: Microsoft.FSharp.Collections.Seq.map</div>
<div class="tip" id="fs154">val cov : float</div>
<div class="tip" id="fs155">val riskPremia : seq&lt;float&gt;<br /><br />Full name: RWTS Mutlivariate Calculations.riskPremia</div>
<div class="tip" id="fs156">val beta : float</div>
<div class="tip" id="fs157">val toList : source:seq&lt;&#39;T&gt; -&gt; &#39;T list<br /><br />Full name: Microsoft.FSharp.Collections.Seq.toList</div>
<div class="tip" id="fs158">val uncVol : float</div>
<div class="tip" id="fs159">val riskPrem : float</div>


          
        </div>
        <div class="span1"></div>
      </div>
      <hr style="margin-top:50px;"/>
      <footer class="footer" style="text-align:center">
        Brought to you by the <a href="http://fsharp.org/technical-groups/">F# Data Science working group</a> and <a href="http://twitter.com/fslaborg">@fslaborg</a>.<br />
        Submit <a href="https://github.com/fslaborg/FsLab">feedback on GitHub</a> and help us improve FsLab!
      </footer>
    </div>
  </body>
</html>
